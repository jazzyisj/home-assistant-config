###############################################################################
## Precipitation Detail
###############################################################################
type: entities
title: "Precipitation Detail"
icon: mdi:weather-pouring
state_color: true
entities:
  - type: conditional
    conditions:
      - entity: binary_sensor.snow
        state: "on"
    row:
      entity: binary_sensor.snow

  - type: conditional
    conditions:
      - entity: binary_sensor.rain
        state: "on"
    row:
      entity: binary_sensor.rain

  - type: conditional
    conditions:
      - entity: binary_sensor.snow
        state: "off"
      - entity: binary_sensor.rain
        state: "off"
    row:
      entity: binary_sensor.precipitation_soon

  - type: conditional
    conditions:
      - entity: binary_sensor.snow
        state: "off"
      - entity: binary_sensor.rain
        state: "off"
    row:
      entity: binary_sensor.precipitation_today

  - type: conditional
    conditions:
      - entity: binary_sensor.snow
        state: "off"
      - entity: binary_sensor.rain
        state: "off"
      - entity: sensor.precipitation_start
        state_not: unknown
    row:
      entity: sensor.precipitation_start

  - type: conditional
    conditions:
      - entity: sensor.precipitation_intensity
        state_not: unknown
    row:
      entity: sensor.precipitation_intensity

  - type: conditional
    conditions:
      - entity: sensor.precipitation_rate
        state_not: unknown
    row:
      entity: sensor.precipitation_rate

  - entity: sensor.precipitation_probability
    name: "Current Precipitation Probability"

  - entity: sensor.precipitation_probability_today
  - entity: sensor.precipitation_expected_today
  - entity: sensor.precipitation_today
  - entity: sensor.nearest_storm_distance
  - entity: sensor.nearest_storm_bearing

  - type: conditional
    conditions:
      - entity: alert.precipitation
        state_not: idle
    row:
      entity: alert.precipitation

  - type: buttons
    entities:
      - entity: sensor.precipitation_today
        name: "Rain Radar"
        tap_action:
          action: navigate
          navigation_path: storm-radar

      - entity: sensor.precipitation_today
        name: "Satellite"
        tap_action:
          action: navigate
          navigation_path: ventusky-satellite

      - entity: sensor.precipitation_today
        name: "Rainviewer"
        tap_action:
          action: fire-dom-event
          browser_mod:
            service: browser_mod.popup
            data:
              content: !include /config/ui/card/weather/rain_viewer_radar.yaml
          timeout: 120000
          card_mod:
            style:
              ha-dialog$: |
                div.mdc-dialog__scrim {
                  backdrop-filter: grayscale(100%) brightness(25%) !important;
                  -webkit-backdrop-filter: grayscale(100%) brightness(25%) !important;
                }
                div.mdc-dialog__surface {
                  background: transparent !important;
                }
    card_mod:
      style:
        hui-buttons-base $: |
          .ha-scrollbar {
            justify-content: center;
          }
card_mod:
  class: basic
