- binary_sensor:
    - unique_id: envcan_connected
      name: EnvCan Connected
      icon: mdi:weather-hurricane
      device_class: connectivity
      state: "{{ states('sensor.envcan_forecast')|lower not in ['unknown','unavailable','none'] }}"

    - unique_id: envcan_weather_alert
      name: EnvCan Weather Alert
      icon: mdi:weather-hurricane
      device_class: safety
      state: >
        {{ states('sensor.envcan_statements')|lower not in ['','unknown','unavailable','none']
            or states('sensor.envcan_advisories')|lower not in ['','unknown','unavailable','none']
            or states('sensor.envcan_watches')|lower not in ['','unknown','unavailable','none']
            or states('sensor.envcan_warnings')|lower not in ['','unknown','unavailable','none'] }}
      attributes:
        title: >
          {% set severity = state_attr('binary_sensor.envcan_weather_alert','severity') %}
          {% if severity == 'warning' %}{{ states('sensor.envcan_warnings') }}
          {% elif severity == 'watch' %}{{ states('sensor.envcan_watches') }}
          {% elif severity == 'advisory' %}{{ states('sensor.envcan_advisories') }}
          {% elif severity == 'statement' %}{{ states('sensor.envcan_statements') }}
          {% endif %}
        severity: >
          {% if states('sensor.envcan_warnings')|lower not in ['','unknown','unavailable','none'] %} warning
          {% elif states('sensor.envcan_watches')|lower not in ['','unknown','unavailable','none'] %} watch
          {% elif states('sensor.envcan_advisories')|lower not in ['','unknown','unavailable','none'] %} advisory
          {% elif states('sensor.envcan_statements')|lower not in ['','unknown','unavailable','none'] %} statement
          {% endif %}
