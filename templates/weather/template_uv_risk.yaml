###############################################################################
## Templates - UV Risk
###############################################################################
- binary_sensor:
    - name: "OpenUV Connected"
      unique_id: openuv_connected
      icon: "{{ 'mdi:weather-sunny-alert' if is_state('binary_sensor.openuv_connected','on') else 'mdi:alert-circle' }}"
      device_class: connectivity
      state: "{{ is_number(states('sensor.current_uv_index')) }}"

    - name: "OpenUV Connected Alert"
      unique_id: openuv_connected_alert
      icon: mdi:weather-sunny-alert
      state: >
        {{ is_state('binary_sensor.openuv_connected','off')
            and is_state('input_boolean.weather_alerts','on')
            and is_state('input_boolean.startup_pending','off') }}

    - unique_id: uv_risk_alert
      state: "{{ states('sensor.max_uv_index')|int > 6 and is_state('input_boolean.weather_alerts','on') }}"
      availability: "{{ is_number(states('sensor.max_uv_index')) }}"

- sensor:
    - name: "UV Risk Today"
      unique_id: uv_risk_today # https://www.openuv.io/uvindex
      icon: mdi:weather-sunny
      state: >
        {% set level = states('sensor.max_uv_index')|int %}
        {% if is_number(level) %}
          {% if level < 3 %} Low
          {% elif level < 7 %} Moderate
          {% elif level < 9 %} High
          {% else %} Very High
          {% endif %}
        {% endif %}
      availability: "{{ is_number(states('sensor.max_uv_index')) }}"

    - name: "UV Index"
      unique_id: uv_index
      icon: mdi:brightness-6
      state_class: measurement
      state: "{{ states('sensor.current_uv_index')|float(default='unknown') }}"
      availability: "{{ is_number(states('sensor.current_uv_index')) }}"
      #OPTION sensor.envcan_uv_index

