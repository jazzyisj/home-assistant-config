###############################################################################
## Templates - Air Quality
###############################################################################
- binary_sensor:
    - name: "WAQI Connected"
      unique_id: waqi_connected
      icon: "{{ 'mdi:smog' if is_state('binary_sensor.waqi_connected','on') else 'mdi:alert-circle' }}"
      device_class: connectivity
      state: "{{ is_number(states('sensor.waqi_windsor')) }}"

    - name: "WAQI Connected Alert"
      unique_id: waqi_connected_alert
      icon: mdi:smog
      state: >
        {{ is_state('binary_sensor.waqi_connected','off')
            and is_state('input_boolean.weather_alerts','on')
            and is_state('input_boolean.startup_pending','off') }}

    - unique_id: air_quality_alert
      state: >
        {{ states('sensor.air_quality_index')|int > 100
            and is_state('input_boolean.weather_alerts','on')
            and is_state('input_boolean.startup_pending','off') }}
      availability: "{{ is_number(states('sensor.air_quality_index')) }}"

- sensor:
    - name: "Air Quality Index"
      unique_id: air_quality_index
      device_class: aqi
      state_class: measurement
      unit_of_measurement: AQI
      state: "{{ states('sensor.waqi_windsor')|float(default='unknown') }}"
      availability: "{{ is_number(states('sensor.waqi_windsor')) }}"
      #OPTION  sensor.envcan_air_quality_health_index

    - name: "AQI Risk Level"
      unique_id: aqi_risk_level
      icon: mdi:smog
      state: >
        {% set level = states('sensor.air_quality_index')|int %}
        {% if is_number(level) %}
          {% if level < 51 %} Good
          {% elif level < 101 %} Moderate
          {% elif level < 101 %} Unhealthy Sensitive Groups
          {% elif level < 201 %} Unhealthy
          {% elif level < 301 %} Very Unhealthy
          {% else %} Hazardous
          {% endif %}
        {% endif %}
      availability: "{{ is_number(states('sensor.air_quality_index')) }}"

    - name: "Ozone"
      unique_id: ozone
      device_class: ozone
      state_class: measurement
      unit_of_measurement: ppb # µg/m³
      state:  "{{ states('sensor.climacell_ozone')|float(default='unknown') }}"
      availability: "{{ is_number(states('sensor.climacell_ozone')) }}"
      #OPTION sensor.current_ozone_level  openuv unit: du <- pay attention
      #OPTION sensor.waqi_windsor attribute: ozone unit: AQI <- pay attention

    - name: "Carbon Monoxide"
      unique_id: carbon_monoxide
      device_class: carbon_monoxide
      state_class: measurement
      unit_of_measurement: ppm # Gas CNG/LPG
      state: "{{ states('sensor.climacell_carbon_monoxide')|float(default='unknown') }}"
      availability: "{{ is_number(states('sensor.climacell_carbon_monoxide')) }}"
      #OPTION sensor.waqi_windsor attribute: co  unit: AQI <- pay attention

    - name: "Nitrogen Dioxide"
      unique_id: nitrogen_dioxide
      device_class: nitrogen_dioxide
      state_class: measurement
      unit_of_measurement: ppb # µg/m³
      state: "{{ states('sensor.climacell_nitrogen_dioxide')|float(default='unknown') }}"
      availability: "{{ is_number(states('sensor.climacell_nitrogen_dioxide')) }}"
      #OPTION sensor.waqi_windsor attribute: nitrogen_dioxide  unit: AQI <- pay attention

    - name: "Sulphur Dioxide"
      unique_id: sulphur_dioxide
      device_class: sulphur_dioxide
      state_class: measurement
      unit_of_measurement: ppb # µg/m³
      state: "{{ states('sensor.climacell_sulfur_dioxide')|float(default='unknown') }}"
      availability: "{{ is_number(states('sensor.climacell_sulfur_dioxide')) }}"
      #OPTION sensor.waqi_windsor attribute: sulfur_dioxide   unit: AQI <- pay attention

    - name: "Particulate Matter 10"
      unique_id: particulate_matter_10
      device_class: pm10
      state_class: measurement
      unit_of_measurement: μg/m³
      state: "{{ states('sensor.climacell_particulate_matter_10_mm')|float(default='unknown') }}"
      availability: "{{ is_number(states('sensor.climacell_particulate_matter_10_mm')) }}"
      #OPTION sensor.waqi_windsor attribute: pm_10  unit: AQI <- pay attention

    - name: "Particulate Matter 2.5"
      unique_id: particulate_matter_2_5
      device_class: pm25
      state_class: measurement
      unit_of_measurement: μg/m³
      state: "{{ states('sensor.climacell_particulate_matter_2_5_mm')|float(default='unknown') }}"
      availability: "{{ is_number(states('sensor.climacell_particulate_matter_2_5_mm')) }}"
      #OPTION sensor.waqi_windsor attribute: pm_2_5  unit: AQI <- pay attention
