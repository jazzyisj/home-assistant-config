- binary_sensor:
    - name: "Window Open"
      unique_id: window_open
      icon: >
        {{ 'mdi:window-open-variant' if is_state('binary_sensor.window_open','on')
            else 'mdi:window-closed-variant' }}
      state: >
        {% if state_attr('binary_sensor.window_open','entities')|lower not in ['unknown','unavailable','none'] %}
          {{ state_attr('binary_sensor.window_open','entities')|count > 0 }}
        {% endif %}
      attributes:
        entities: >
          {{ states.binary_sensor|selectattr('attributes.device_class','eq','window')
            |selectattr('state','eq','on')|map(attribute='entity_id')|list }}
