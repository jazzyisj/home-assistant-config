- binary_sensor:
    - unique_id: nest_connected
      name: Nest Connected
      icon: "{{ 'mdi:home-circle' if is_state('binary_sensor.nest_connected','on') else 'mdi:alert-circle' }}"
      device_class: connectivity
      state: > # # if any nest devices is connected then Nest is online
        {{ is_state('binary_sensor.upstairs_thermostat_online','on')
            or is_state('binary_sensor.upstairs_nest_protect_online','on')
            or is_state('binary_sensor.upstairs_nest_protect_online','on') }}

    - unique_id: nest_connected_alert
      name: Nest Connected Alert
      icon: mdi:smoke-detector
      state: "{{ is_state('binary_sensor.nest_connected','off') and is_state('input_boolean.system_alerts','on') }}"

    - unique_id: protect_offline
      name: Protect Offline
      icon: mdi:smoke-detector
      state: >
        {{ not is_state('binary_sensor.downstairs_nest_protect_online','on')
            or not is_state('binary_sensor.upstairs_nest_protect_online','on') }}
      availability: "{{ is_state('binary_sensor.nest_connected','on') }}"