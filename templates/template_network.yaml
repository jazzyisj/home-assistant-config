- binary_sensor:
    - name: "WIFI AP Upstairs Connected"
      unique_id: wifi_ap_upstairs_connected
      icon: mdi:wifi
      device_class: connectivity
      state: "{{ is_state('device_tracker.wifi_ap_upstairs','home') }}"


    - name: "WIFI AP Upstairs Connected Alert"
      unique_id: wifi_ap_upstairs_connected_alert
      icon: mdi:wifi
      delay_on:
        minutes: 1 # allow for temporary disconnections before alerting
      state: >
        {{ is_state('binary_sensor.wifi_ap_upstairs_connected','off')
            and is_state('input_boolean.network_alerts','on')
            and is_state('input_boolean.startup_pending','off') }}

    - name: "Speedtest Connected"
      unique_id: speedtest_connected
      icon: mdi:speedometer
      device_class: connectivity
      state: "{{ states('sensor.speedtest_download')|lower not in ['unknown','unavailable','none'] }}"

    - name: "Speedtest Connected Alert"
      unique_id: speedtest_connected_alert
      icon: mdi:speedometer
      state: >
        {{ is_state('binary_sensor.speedtest_connected','off')
            and is_state('input_boolean.network_alerts','on')
            and is_state('input_boolean.startup_pending','off') }}

    - name: "WAN Connected Alert"
      unique_id: wan_connected_alert
      icon: mdi:wan
      delay_on:
        minutes: 5 # allow for temporary disconnections before alerting
      state: >
        {{ is_state('binary_sensor.wan_connected','off')
            and is_state('input_boolean.network_alerts','on')
            and is_state('input_boolean.startup_pending','off') }}

    - name: "PiHole Disconnected Alert"
      unique_id: pihole_disconnected_alert
      icon: mdi:pi-hole
      delay_on:
        minutes: 5 # allow for temporary disconnections before alerting
      state: >-
        {{ states('sensor.pi_hole_domains_blocked')|lower in ['unknown','unavailable','none']
            and is_state('input_boolean.network_alerts','on')
            and is_state('input_boolean.startup_pending','off') }}
