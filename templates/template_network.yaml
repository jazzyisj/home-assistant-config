- binary_sensor:
    - unique_id: speedtest_connected
      name: Speedtest Connected
      icon: mdi:speedometer
      device_class: connectivity
      state: "{{ states('sensor.speedtest_download')|lower not in ['unknown','unavailable','none'] }}"

    - unique_id: speedtest_connected_alert
      name: Speedtest Connected Alert
      icon: mdi:speedometer
      state: >
        {{ is_state('binary_sensor.speedtest_connected','off')
            and is_state('input_boolean.system_alerts','on')
            and is_state('input_boolean.startup_pending','off') }}

    - unique_id: wan_connected_alert
      name: WAN Connected Alert
      icon: mdi:wan
      delay_on:
        minutes: 5 # allow for temporary disconnections before alerting
      state: >
        {{ is_state('binary_sensor.wan_connected','off')
            and is_state('input_boolean.system_alerts','on')
            and is_state('input_boolean.startup_pending','off') }}

    - name: PiHole Disconnected Alert
      unique_id: pihole_disconnected_alert
      icon: mdi:pi-hole
      delay_on:
        minutes: 5 # allow for temporary disconnections before alerting
      state: >-
        {{ states('sensor.pi_hole_domains_blocked')|lower in ['unknown','unavailable','none']
            and is_state('input_boolean.system_alerts','on')
            and is_state('input_boolean.startup_pending','off') }}
