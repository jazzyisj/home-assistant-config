###############################################################################
## Templates - PiHole
###############################################################################
- binary_sensor:
    - name: "PiHole Disconnected Alert"
      unique_id: pihole_disconnected_alert
      icon: mdi:pi-hole
      delay_on: 300
      state: >
        {{ (is_state('sensor.pi_hole_status','Disconnected')
            or is_state('device_tracker.pi_hole','away'))
            and is_state('input_boolean.network_alerts','on') }}

    - name: "PiHole Disabled Alert"
      unique_id: pihole_disabled_alert
      icon: mdi:pi-hole
      delay_on: 3600
      state: >
        {{ is_state('sensor.pi_hole_status','Disabled')
          and is_state('input_boolean.network_alerts','on') }}

- sensor:
    # https://github.com/ironsheep/RPi-Reporter-MQTT2HA-Daemon
    - name: "RPi Memory Use Percent"
      unique_id: rpi_memory_use_percent
      icon: mdi:memory
      unit_of_measurement: "%"
      state: >
        {% if state_attr('sensor.rpi_monitor_raspberrypi','memory') != none %}
          {% set total = state_attr('sensor.rpi_monitor_raspberrypi','memory')['size_mb']|float(-1) %}
          {% set free = state_attr('sensor.rpi_monitor_raspberrypi','memory')['free_mb']|float(-1) %}
          {{ ((total - free) / total * 100)|int(-1) }}
        {% endif %}
