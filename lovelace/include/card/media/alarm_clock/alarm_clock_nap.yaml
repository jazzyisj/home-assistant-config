type: entities
title: Nap Alarm Clock
entities:
  - type: custom:fold-entity-row
    head:
      type: custom:template-entity-row
      entity: sensor.alarm_clock_nap # don't use entity include - recursive popup
      name: Nap Alarm Time
      state: "{{ state_attr('sensor.alarm_clock_nap','12hour') }}"
      tap_action:
        action: none
      card_mod:
        style: |
          :host {
            --paper-item-icon-color:
              {% if is_state('sensor.alarm_clock_nap','off') %} var(--state-icon-color)
              {% else %} var(--state-icon-active-color)
              {% endif %}
              ;
          }
    entities:
      - entity: input_number.alarm_clock_nap_time
        name: Duration

      - entity: timer.alarm_clock_nap
        name: Remaining
        card_mod:
          style: |
            :host {
              --paper-item-icon-color:
                {% if is_state('timer.alarm_clock_nap','idle') %} var(--state-icon-color)
                {% else %} var(--state-icon-active-color)
                {% endif %}
                ;
            }

  - type: custom:fold-entity-row
    head:
      type: custom:template-entity-row
      entity: sensor.alarm_clock_nap
      icon: mdi:playlist-music
      name: >
        {% set media_type = states('input_select.alarm_clock_sound_nap')|lower %}
        {% if media_type in ['radio','spotify','youtube'] %}
          {{ states('input_select.alarm_clock_' ~ media_type ~ '_nap') }}
        {% else %} {{ media_type|title }}
        {% endif %}
      secondary: "{{ states('input_select.alarm_clock_media_player_nap') }}"
      state: "{{ states('input_number.alarm_clock_volume_nap') }}%"
      tap_action:
        action: none
    padding: 0
    entities:
      - entity: input_select.alarm_clock_sound_nap

      - type: conditional
        conditions:
          - entity: input_select.alarm_clock_sound_nap
            state: Radio
        row:
          entity: input_select.alarm_clock_radio_nap

      - type: conditional
        conditions:
          - entity: input_select.alarm_clock_sound_nap
            state: Spotify
        row:
          entity: input_select.alarm_clock_spotify_nap

      - type: conditional
        conditions:
          - entity: input_select.alarm_clock_sound_nap
            state: Youtube
        row:
          entity: input_select.alarm_clock_youtube_nap

      - entity: input_select.alarm_clock_media_player_nap
      - entity: input_number.alarm_clock_volume_nap

  - !include /config/lovelace/include/entity/alarm_clock/alarm_clock_common_settings.yaml

  - type: divider

  - type: custom:paper-buttons-row
    buttons:
      - entity: input_boolean.alarm_clock_nap
        name: "{{ 'Alarm Set' if is_state('input_boolean.alarm_clock_nap','on') else 'Set Alarm' }}"
        state_icons:
          'on': mdi:alarm-check
          'off': mdi:alarm-off
        state_styles:
          'on':
            button:
              color: var(--state-icon-active-color)
          'off':
            button:
              color: var(--state-icon-color)
        style:
          button:
            background-color: var(--table-row-alternative-background-color)
            border-radius: 40px
            padding: 10px
            font-size: 1.2rem
        tap_action:
          action: toggle

      - entity: switch.alarm_clock_nap
        name: "{{ 'Stop Alarm' if is_state('switch.alarm_clock_nap','on') else 'Test Alarm' }}"
        state_icons:
          'on': mdi:alarm-note
          'off': mdi:alarm-note-off
        state_styles:
          'on':
            button:
              color: var(--state-icon-active-color)
          'off':
            button:
              color: var(--state-icon-color)
        style:
          button:
            background-color: var(--table-row-alternative-background-color)
            border-radius: 40px
            padding: 10px
            font-size: 1.2rem
        tap_action:
          action: call-service
          service: script.alarm_clock_toggle
          service_data:
            alarm_type: nap
            test_play: true
        double_tap_action:
          action: call-service
          service: script.alarm_clock_stop
          service_data:
            alarm_type: nap
    card_mod:
      class: basic
