###############################################################################
## Alarm Clock - Auto
###############################################################################
type: entities
title: Auto Alarm Clock
entities:
  - type: custom:fold-entity-row
    head:
      type: custom:template-entity-row
      entity: sensor.alarm_clock_auto # don't use entity include - recursive popup
      name: Auto Alarm Time
      state: "{{ state_attr('sensor.alarm_clock_auto','12hour') }}"
      icon: mdi:clock
      tap_action:
        action: none
      card_mod:
        style: |
          :host {
            --paper-item-icon-color:
              {% if is_state('sensor.alarm_clock_auto','off') %} var(--state-icon-color)
              {% else %} var(--state-icon-active-color)
              {% endif %}
              ;
          }
    padding: 0
    entities:
      - !include /config/lovelace/include/entity/schedule/datetime_picker_days.yaml
      - !include /config/lovelace/include/entity/schedule/datetime_picker_afternoons.yaml
      - !include /config/lovelace/include/entity/schedule/datetime_picker_weekends.yaml
      - !include /config/lovelace/include/entity/schedule/datetime_picker_guest.yaml
    card_mod:
      class: sub_card

  - type: custom:fold-entity-row
    head:
      type: custom:template-entity-row
      entity: sensor.alarm_clock_auto
      icon: mdi:playlist-music
      name: >
        {% set media_type = states('input_select.alarm_clock_sound_auto')|lower %}
        {% if media_type in ['radio','spotify','youtube'] %}
          {{ states('input_select.alarm_clock_' ~ media_type ~ '_auto') }}
        {% else %} {{ media_type|title }}
        {% endif %}
      secondary: "{{ states('input_select.alarm_clock_media_player_auto') }}"
      state: "{{ states('input_number.alarm_clock_volume_auto') }}%"
      tap_action:
        action: none
    padding: 0
    entities:
      - entity: input_select.alarm_clock_sound_auto

      - type: conditional
        conditions:
          - entity: input_select.alarm_clock_sound_auto
            state: Radio
        row:
          entity: input_select.alarm_clock_radio_auto

      - type: conditional
        conditions:
          - entity: input_select.alarm_clock_sound_auto
            state: Spotify
        row:
          entity: input_select.alarm_clock_spotify_auto

      - type: conditional
        conditions:
          - entity: input_select.alarm_clock_sound_auto
            state: Youtube
        row:
          entity: input_select.alarm_clock_youtube_auto

      - entity: input_select.alarm_clock_media_player_auto
      - entity: input_number.alarm_clock_volume_auto
        icon: mdi:volume-high

  - !include /config/lovelace/include/entity/alarm_clock/alarm_clock_common_settings.yaml

  - type: custom:paper-buttons-row
    buttons:
      - entity: input_boolean.alarm_clock_auto_workdays
        name: "{{ 'Work Days' if is_state('input_boolean.alarm_clock_auto_workdays','on') else 'Set Work Days' }}"
        state_icons:
          'on': mdi:alarm-check
          'off': mdi:alarm-off
        state_styles:
          'on':
            button:
              color: var(--state-icon-active-color)
          'off':
            button:
              color: var(--state-icon-color)
        style:
          button:
            background-color: var(--table-row-alternative-background-color)
            border-radius: 40px
            padding: 10px
            font-size: 1.2rem
        tap_action:
          action: toggle

      - entity: input_boolean.alarm_clock_auto_weekends
        name: "{{ 'Weekends' if is_state('input_boolean.alarm_clock_auto_weekends','on') else 'Set Weekends' }}"
        state_icons:
          'on': mdi:alarm-check
          'off': mdi:alarm-off
        state_styles:
          'on':
            button:
              color: var(--state-icon-active-color)
          'off':
            button:
              color: var(--state-icon-color)
        style:
          button:
            background-color: var(--table-row-alternative-background-color)
            border-radius: 40px
            padding: 10px
            font-size: 1.2rem
        tap_action:
          action: toggle

  - type: custom:paper-buttons-row
    buttons:
      - entity: switch.alarm_clock_auto
        name: "{{ 'Stop Alarm' if is_state('switch.alarm_clock_auto','on') else 'Test Alarm' }}"
        state_icons:
          'on': mdi:alarm-note
          'off': mdi:alarm-note-off
        state_styles:
          'on':
            button:
              color: var(--state-icon-active-color)
          'off':
            button:
              color: var(--state-icon-color)
        style:
          button:
            background-color: var(--table-row-alternative-background-color)
            border-radius: 40px
            padding: 10px
            font-size: 1.2rem
        tap_action:
          action: call-service
          service: script.alarm_clock_toggle
          service_data:
            alarm_type: auto
            test_play: true
        double_tap_action:
          action: call-service
          service: script.alarm_clock_stop
          service_data:
            alarm_type: auto
card_mod:
  class: basic
