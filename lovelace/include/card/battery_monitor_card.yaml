#######################################################################################################################
## Battery Monitor Card  https://github.com/maxwroc/battery-state-card
#BUG filter doesnt work if in swipe and vertical stack in card together
#######################################################################################################################
type: custom:vertical-stack-in-card
cards:
  - type: entities
    title: Battery Levels
    icon: mdi:battery
    show_header_toggle: false
    state_color: true
    style: |
      .card-header {
        font-size: 22px;
        font-variant: small-caps;
      }
    entities:
      - type: custom:fold-entity-row
        head:
          entity: binary_sensor.low_battery_alert
          style: |
            :host {
              --paper-item-icon-color:
                {%- if is_state('binary_sensor.low_battery_alert','on') %} var(--entity-critical-color)
                {%- else %} var(--state-icon-active-color)
                {%- endif -%}
                ;
            }
        entities:
          - entity: input_number.battery_alert_threshold
            style: |
              :host {
                --paper-item-icon-active-color: var(--entity-critical-color);
              }

  - type: custom:battery-state-card
    title: Batteries
    sort_by_level: asc
    collapse: 4
    style: |
      .card-header {
        font-size: 16px;
        font-variant: small-caps;
      }
    state_map:
      - from: "Ok"
        to: 100
      - from: "Replace"
        to: 25
    filter:
      include:
        - name: entity_id
          value: "*_battery_level"
        - name: attributes.device_class
          value: battery
        - name: entity_id
          value: "*_nest_protect_battery_health"
      exclude:
        - name: entity_id
          value: "*_battery_state"