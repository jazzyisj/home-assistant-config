# status - Actual
# messageType - Alert, Update
# severity - Severe, Moderate, Extreme
# HazardType - Heavy Snow, Snow
# certainty - Possible, Likely, Observed
# urgency - Expected
# Event - Special Weather Statement, Winter Weather Advisory

type: custom:html-template-card
ignore_line_breaks: true
# do_not_parse: true
# always_update: false
entities: sensor.noaa_alerts_miz076
style: |
  ha-card {
    background: purple !important;
    color: cyan !important;
    font-weight: bold;
    font-size: 14px;
  }
#STYLE style: |
#   ha-card {
#     background:
#       {% if state_attr('sensor.noaa_alerts_miz076','severity')|lower == 'extreme' %} var(--entity-critical-color)
#       {% elif state_attr('sensor.noaa_alerts_miz076','severity')|lower == 'severe' %} var(--entity-critical-color)
#       {% elif state_attr('sensor.noaa_alerts_miz076','severity')|lower == 'moderate' %} var(--entity-warning-color)
#       {% elif state_attr('sensor.noaa_alerts_miz076','severity')|lower == 'minor' %} var(--entity-warning-color)
#       {% else %} white
#       {% endif %}
#       ;
#     color:
#       {% if state_attr('sensor.noaa_alerts_miz076','severity')|lower == 'extreme' %} white
#       {% elif state_attr('sensor.noaa_alerts_miz076','severity')|lower == 'severe' %} white
#       {% elif state_attr('sensor.noaa_alerts_miz076','severity')|lower == 'moderate' %} black
#       {% elif state_attr('sensor.noaa_alerts_miz076','severity')|lower == 'minor' %} black
#       {% else %} black
#       {% endif %}
#       ;
#     font-weight: bold;
#     font-size: 14px;
#   }
content: >
  {% if is_state('sensor.noaa_alerts_miz076','0') %}
    No Active Alerts
  {% else %}
    {% for alert in states.sensor.noaa_alerts_miz076.attributes.alerts %}
      <p>{{ states.sensor.noaa_alerts_miz076.attributes.alerts[loop.index0].parameters.NWSheadline|replace('[\'', '')|replace('\']', '') }}</p>
      <p>The National Weather Service has issued a
      {{ states.sensor.noaa_alerts_miz076.attributes.alerts[loop.index0].event }} in effect from
      {{ as_timestamp(states.sensor.noaa_alerts_miz076.attributes.alerts[loop.index0].effective)|timestamp_custom('%_I:%M %p %A') }} until
      {{ as_timestamp(states.sensor.noaa_alerts_miz076.attributes.alerts[loop.index0].expires)|timestamp_custom('%_I:%M %p %A') }}.
      {% if states.sensor.noaa_alerts_miz076.attributes.alerts[loop.index0].parameters.HazardType %}
        {{ states.sensor.noaa_alerts_miz076.attributes.alerts[loop.index0].parameters.HazardType|replace('[\'', '')|replace('\']', '') }}
        {{ states.sensor.noaa_alerts_miz076.attributes.alerts[loop.index0].certainty }}
      {% endif %}
      {% if not states.sensor.noaa_alerts_miz076.attributes.alerts[loop.index0].instruction in ['None', '', null] %}
        {{ states.sensor.noaa_alerts_miz076.attributes.alerts[loop.index0].instruction }}
      {% endif %}</p>
      <p style='font-size:22px;font-weight:bold;'><ha-icon icon="mdi:weather-sunny"></ha-icon>{{ states.sensor.noaa_alerts_miz076.attributes.alerts[loop.index0].event }}</p>
      <p>{{ states.sensor.noaa_alerts_miz076.attributes.alerts[loop.index0].description|replace('*', '<br/>') }}</p>
      <p style="font-size:12px;">
      <br/>Headline: {{ states.sensor.noaa_alerts_miz076.attributes.alerts[loop.index0].headline }}
      <br/>Response: {{ states.sensor.noaa_alerts_miz076.attributes.alerts[loop.index0].response }}
      <br/>Hazzard Type: {{ states.sensor.noaa_alerts_miz076.attributes.alerts[loop.index0].parameters.HazardType|replace('[\'', '')|replace('\']', '') }}
      <br/>Issued: {{ as_timestamp(states.sensor.noaa_alerts_miz076.attributes.alerts[loop.index0].effective)|timestamp_custom('%a %B %d,%_I:%M %p') }}
      <br/>Onset: {{ as_timestamp(states.sensor.noaa_alerts_miz076.attributes.alerts[loop.index0].onset)|timestamp_custom('%a %B %d,%_I:%M %p') }}
      <br/>Expires: {{ as_timestamp(states.sensor.noaa_alerts_miz076.attributes.alerts[loop.index0].expires)|timestamp_custom('%a %B %d,%_I:%M %p') }}
      <br/>Ends: {{ as_timestamp(states.sensor.noaa_alerts_miz076.attributes.alerts[loop.index0].ends)|timestamp_custom('%a %B %d,%_I:%M %p') }}
      <br/>Status: {{ states.sensor.noaa_alerts_miz076.attributes.alerts[loop.index0].status }}
      <br/>Type: {{ states.sensor.noaa_alerts_miz076.attributes.alerts[loop.index0].messageType }}
      <br/>Category: {{ states.sensor.noaa_alerts_miz076.attributes.alerts[loop.index0].category }}
      <br/>Severity: {{ states.sensor.noaa_alerts_miz076.attributes.alerts[loop.index0].severity }}
      <br/>Certainty: {{ states.sensor.noaa_alerts_miz076.attributes.alerts[loop.index0].certainty }}
      <br/>Urgency: {{ states.sensor.noaa_alerts_miz076.attributes.alerts[loop.index0].urgency }}
      <br/>Event: {{ states.sensor.noaa_alerts_miz076.attributes.alerts[loop.index0].event }}
      <br/>Sender: {{ states.sensor.noaa_alerts_miz076.attributes.alerts[loop.index0].sender }}
      <br/>Name: {{ states.sensor.noaa_alerts_miz076.attributes.alerts[loop.index0].senderName }}</p>
    {% endfor %}
  {% endif %}