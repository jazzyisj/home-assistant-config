###############################################################################
## Auto Alarm Clock Card
###############################################################################
# type: custom:swipe-card
# card_width: '98%'
# start_card: 1
# reset_after: 120
# parameters: !include /config/lovelace/lovelace_swipe_parameters.yaml
type: vertical-stack
cards:
  - type: entities
    title: Auto Alarm Clock
    entities:
      - type: custom:fold-entity-row
        head:
          type: custom:template-entity-row
          entity: sensor.alarm_clock_auto_next_alarm
          name: Auto Alarm Time
          state: "{{ state_attr('sensor.alarm_clock_auto_next_alarm','12hour') }}"
          icon: mdi:clock
          tap_action:
            action: none
          card_mod:
            style: |
              :host {
                --paper-item-icon-color:
                  {% if is_state('sensor.alarm_clock_auto_next_alarm','off') %} var(--state-icon-color)
                  {% else %} var(--state-icon-active-color)
                  {% endif %}
                  ;
              }
        padding: 0
        entities: # https://github.com/GeorgeSG/lovelace-time-picker-card
          - type: custom:hui-element
            card_type: custom:time-picker-card
            entity: input_datetime.days_waketime
            name: Days
            hour_mode: 12
            link_values: true
            hour_step: 1
            minute_step: 1
            layout:
              name: inside
              align_controls: right
              hour_mode: single
              embedded: true
            hide:
              name: false
              seconds: true
            card_mod:
              class: sub_card

          - type: custom:hui-element
            card_type: custom:time-picker-card
            entity: input_datetime.afternoons_waketime
            name: Afternoons
            hour_mode: 12
            link_values: true
            hour_step: 1
            minute_step: 1
            layout:
              name: inside
              align_controls: right
              hour_mode: single
              embedded: true
            hide:
              name: false
              seconds: true
            card_mod:
              class: sub_card

          - type: custom:hui-element
            card_type: custom:time-picker-card
            entity: input_datetime.weekend_waketime
            name: Weekends
            hour_mode: 12
            link_values: true
            hour_step: 1
            minute_step: 1
            layout:
              name: inside
              align_controls: right
              hour_mode: single
              embedded: true
            hide:
              name: false
              seconds: true
            card_mod:
              class: sub_card

          - type: custom:hui-element
            card_type: custom:time-picker-card
            entity: input_datetime.guest_waketime
            name: Guest
            hour_mode: 12
            link_values: true
            hour_step: 1
            minute_step: 1
            layout:
              name: inside
              align_controls: right
              hour_mode: single
              embedded: true
            hide:
              name: false
              seconds: true
            card_mod:
              class: sub_card

        card_mod:
          class: sub_card

      - type: custom:fold-entity-row
        head:
          type: custom:template-entity-row
          entity: sensor.alarm_clock_auto_next_alarm
          icon: mdi:playlist-music
          name: >
            {% set media_type = states('input_select.alarm_clock_sound_auto')|lower %}
            {% if media_type in ['radio','spotify','youtube'] %}
              {{ states('input_select.alarm_clock_' ~ media_type ~ '_auto') }}
            {% else %} {{ media_type|title }}
            {% endif %}
          secondary: "{{ states('input_select.alarm_clock_media_player_auto') }}"
          state: "{{ states('input_number.alarm_clock_volume_auto') }}%"
          tap_action:
            action: none
        padding: 0
        entities:
          - entity: input_select.alarm_clock_sound_auto

          - type: conditional
            conditions:
              - entity: input_select.alarm_clock_sound_auto
                state: Radio
            row:
              entity: input_select.alarm_clock_radio_auto

          - type: conditional
            conditions:
              - entity: input_select.alarm_clock_sound_auto
                state: Spotify
            row:
              entity: input_select.alarm_clock_spotify_auto

          - type: conditional
            conditions:
              - entity: input_select.alarm_clock_sound_auto
                state: Youtube
            row:
              entity: input_select.alarm_clock_youtube_auto

          - entity: input_select.alarm_clock_media_player_auto
          - entity: input_number.alarm_clock_volume_auto

      - type: buttons
        entities:
          - entity: input_boolean.alarm_clock_auto_workdays
            name: Workdays
            tap_action:
              action: toggle

          - entity: input_boolean.alarm_clock_auto_weekends
            name: Weekends
            tap_action:
              action: toggle

          - entity: switch.alarm_clock_auto
            name: Test Alarm
            tap_action:
              action: toggle
              tap_action:
                action: call-service
                service: script.alarm_clock_toggle
                service_data:
                  alarm_type: auto
                  test_play: true
              double_tap_action:
                action: call-service
                service: script.alarm_clock_stop
                service_data:
                  alarm_type: auto
        card_mod:
          style:
            hui-buttons-base $: |
              .ha-scrollbar {
                justify-content: center;
              }
    card_mod:
      class: basic

  - !include /config/lovelace/card/media/alarm_clock/alarm_clock_settings.yaml
