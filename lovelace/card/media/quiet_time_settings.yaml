###############################################################################
## Volume Settings
###############################################################################
type: entities
title: 'Volume Settings'
icon: mdi:volume-low
show_header_toggle: false
entities:
  - type: custom:fold-entity-row
    head:
      type: custom:template-entity-row
      name: Volume Settings
      icon: mdi:volume-medium
    padding: 5
    entities:
      - entity: input_number.media_default_volume
      - entity: input_number.volume_log_factor
      - entity: input_boolean.volume_balancing

      - type: custom:fold-entity-row
        padding: 0
        head: input_boolean.media_type_volume_adjustments
        entities:
          - entity: input_number.radio_volume_adjustment
          - entity: input_number.spotify_volume_adjustment
          - entity: input_number.youtube_volume_adjustment

      - type: custom:auto-entities
        filter:
          include:
            - entity_id: 'input_number.*_default_volume'
          exclude:
            - entity_id: input_number.media_default_volume
        sort:
          method: name
          ignore_case: true
        card:
          type: custom:fold-entity-row
          head:
            type: custom:template-entity-row
            name: Default Volume Levels
            icon: mdi:volume-source
          padding: 5

  - type: section
    label: 'System Mute'

  - entity: switch.system_mute
  - entity: input_number.timed_mute_duration

  - type: section
    label: 'Quiet Time'

  - type: custom:fold-entity-row
    head:
      entity: binary_sensor.quiet_time
      state_color: true
    entities:
      - entity: input_boolean.quiet_time_enabled
        name: Enable Quiet Time
        card_mod:
          style: |
            :host {
              --paper-item-icon-color:
                {% if is_state('input_boolean.quiet_time_enabled','off') %} var(--entity-warning-color)
                {% else %} var(--state-icon-color)
                {% endif %}
              ;
            }

      - entity: input_boolean.quiet_time_override
        name: Quiet Time Override
        card_mod:
          style: |
            :host {
              --paper-item-icon-color:
                {% if is_state('input_boolean.quiet_time_override','on') %} var(--entity-warning-color)
                {% else %} var(--state-icon-color)
                {% endif %}
              ;
            }

      - type: conditional
        conditions:
          - entity: input_boolean.quiet_time_enabled
            state: 'on'
        row:
          entity: input_boolean.quiet_time_bedtime_sync
          name: Sync To Bed/Wake Times

      - type: conditional
        conditions:
          - entity: input_boolean.quiet_time_enabled
            state: 'on'
          - entity: input_boolean.quiet_time_bedtime_sync
            state: 'on'
        row:
          type: attribute
          entity: sensor.quiet_time_start
          attribute: 12hour

      - type: conditional
        conditions:
          - entity: input_boolean.quiet_time_enabled
            state: 'on'
          - entity: input_boolean.quiet_time_bedtime_sync
            state: 'on'
        row:
          type: attribute
          entity: sensor.quiet_time_end
          attribute: 12hour

      - type: conditional
        conditions:
          - entity: input_boolean.quiet_time_bedtime_sync
            state: 'on'
          - entity: input_boolean.quiet_time_enabled
            state: 'on'
        row:
          entity: input_number.quiet_minutes_before_bedtime
          name: Before Bedtime

      - type: conditional
        conditions:
          - entity: input_boolean.quiet_time_bedtime_sync
            state: 'on'
          - entity: input_boolean.quiet_time_enabled
            state: 'on'
        row:
          entity: input_number.quiet_minutes_after_waketime
          name: After Waketime

      - type: conditional
        conditions:
          - entity: input_boolean.quiet_time_enabled
            state: 'on'
          - entity: input_boolean.quiet_time_bedtime_sync
            state: 'off'
        row:
          entity: input_datetime.quiet_time_start

      - type: conditional
        conditions:
          - entity: input_boolean.quiet_time_enabled
            state: 'on'
          - entity: input_boolean.quiet_time_bedtime_sync
            state: 'off'
        row:
          entity: input_datetime.quiet_time_end

  - type: conditional
    conditions:
      - entity: input_boolean.quiet_time_enabled
        state: 'on'
    row:
      type: section
      label: Quiet Time Volume Settings

  - type: conditional
    conditions:
      - entity: input_boolean.quiet_time_enabled
        state: 'on'
    row:
      entity: input_boolean.volume_override #STYLE doesn't work in conditional row

  - type: conditional
    conditions:
      - entity: input_boolean.quiet_time_enabled
        state: 'on'
    row:
      type: custom:fold-entity-row
      head:
        type: custom:template-entity-row
        name: Quiet Time Volumes
      entities:
        - type: conditional
          conditions:
            - entity: input_boolean.quiet_time_enabled
              state: 'on'
          row:
            entity: input_number.speaker_quiet_volume
            name: Speakers

        - type: conditional
          conditions:
            - entity: input_boolean.quiet_time_enabled
              state: 'on'
          row:
            entity: input_number.tv_quiet_volume
            name: Televisions

        - type: conditional
          conditions:
            - entity: input_boolean.quiet_time_enabled
              state: 'on'
          row:
            entity: input_number.media_quiet_volume
            name: Media

  - type: conditional
    conditions:
      - entity: input_boolean.quiet_time_enabled
        state: 'on'
    row:
      type: custom:fold-entity-row
      head:
        type: custom:template-entity-row
        name: TTS Quiet Time Settings
      entities:
        - type: conditional
          conditions:
            - entity: input_boolean.quiet_time_enabled
              state: 'on'
          row:
            entity: input_select.tts_media_player_quiet
            name: Quiet Time Media Player

        - type: conditional
          conditions:
            - entity: input_boolean.quiet_time_enabled
              state: 'on'
          row:
            entity: input_number.tts_volume_quiet
            name: TTS Quiet Volume

        - type: conditional
          conditions:
            - entity: input_boolean.quiet_time_enabled
              state: 'on'
          row:
            entity: input_number.tts_volume_night
            name: TTS Night Volume
card_mod:
  class: basic
