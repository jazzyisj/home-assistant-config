type: custom:html-template-card
ignore_line_breaks: true
entities: sensor.dark_sky_alerts
#DARKSKY - 1st dark sky alert is nonsense, skip
content: >
  {%- if is_state('sensor.dark_sky_alerts','0') %}
    No Active Alerts
  {%- else %}
    {%- for item in range(states('sensor.dark_sky_alerts')|int(0)) %}
      {%- if not loop.first %}
        <h2>{{ state_attr('sensor.dark_sky_alerts','title_' ~ loop.index0) }}</h2>
        <br/><b>Severity:</b> {{ state_attr('sensor.dark_sky_alerts','severity_' ~ loop.index0) }}
        <br/><b>Effective:</b> {{ as_datetime(state_attr('sensor.dark_sky_alerts','time_' ~ loop.index0))
          |as_timestamp(none)|timestamp_custom('%a %D %-I:%M %p',true,none) }}
        <br/><b>Expires:</b> {{ as_datetime(state_attr('sensor.dark_sky_alerts','expires_' ~ loop.index0))
          |as_timestamp(none)|timestamp_custom('%a %D %-I:%M %p',true,none) }}
        <br/><b>Description:</b> {{ state_attr('sensor.dark_sky_alerts','description_' ~ loop.index0).split('###')[0] }}
        <br/><b>Link:</b><a href="{{ state_attr('sensor.dark_sky_alerts','uri_' ~ loop.index0) }}">
          {{ state_attr('sensor.dark_sky_alerts','uri_' ~ loop.index0) }}</a></p>
      {%- endif %}
    {%- endfor %}
  {%- endif %}
card_mod:
  class: popup
