###############################################################################
## Weather Card Sensors
###############################################################################
type: glance
show_state: false
show_name: false
columns: 8
entities:
  - entity: binary_sensor.storm_approaching_alert #IDEA - storm alert text in sensor
    card_mod:
      style: |
        :host {
          --paper-item-icon-color:
            {% if is_state('binary_sensor.storm_approaching_alert','on') %} var(--entity-warning-color)
            {% else %} var(--entity-ok-color)
            {% endif %}
          ;
        }
    tap_action:
      action: fire-dom-event
      browser_mod:
        command: popup
        deviceID: this
        large: true
        hide_header: true
        title: 'Windy Radar Map'
        card: !include /config/lovelace/card/weather/windy_radar.yaml
    double_tap_action:
      action: url
      url_path: !secret WINDY_RADAR
    hold_action:
      action: call-service
      service: alert.toggle
      service_data:
        entity_id: alert.storm_approaching

  - type: custom:template-entity-row
    entity: sensor.tempest_st_00057689_lightning_count
    icon: mdi:flash
    card_mod:
      style: |
        :host {
          --paper-item-icon-color:
            {% if states('sensor.tempest_st_00057689_lightning_count')|int(-1) > 0 %} var(--entity-warning-color)
            {% else %} var(--entity-ok-color)
            {% endif %}
          ;
        }
    tap_action:
      action: fire-dom-event
      browser_mod:
        command: popup
        deviceID: this
        large: true
        hide_header: true
        title: 'Windy Radar Map'
        card: !include /config/lovelace/card/weather/windy_radar.yaml
    double_tap_action:
      action: url
      url_path: !secret WINDY_RADAR
    hold_action:
      action: call-service
      service: alert.toggle
      service_data:
        entity_id: alert.storm_approaching

  - entity: sensor.allergy_risk_today
    card_mod:
      style: |
        :host {
          --paper-item-icon-color:
            {% set level = states('sensor.allergy_index_today')|float(0) %}
            {% if level < 2.5 %} var(--entity-ok-color)
            {% elif level < 4.9 %} var(--entity-minor-color)
            {% elif level < 7.3 %} var(--entity-warning-color)
            {% elif level < 9.7 %} var(--entity-severe-color)
            {% else %} var(--entity-critical-color)
            {% endif %}
          ;
        }
    tap_action:
      action: more-info
    double_tap_action:
      action: url
      url_path: !secret POLLEN_FORECAST
    hold_action:
      action: call-service
      service: alert.toggle
      service_data:
        entity_id: alert.allergy_risk

  - entity: sensor.asthma_risk_today
    card_mod:
      style: |
        :host {
          --paper-item-icon-color:
            {% set level = states('sensor.asthma_risk_today')|float(0) %}
            {% if level < 2.5 %} var(--entity-ok-color)
            {% elif level < 4.9 %} var(--entity-minor-color)
            {% elif level < 7.3 %} var(--entity-warning-color)
            {% elif level < 9.7 %} var(--entity-severe-color)
            {% else %} var(--entity-critical-color)
            {% endif %}
          ;
        }
    tap_action:
      action: more-info
    double_tap_action:
      action: url
      url_path: !secret ASTHMA_FORECAST
    hold_action:
      action: call-service
      service: alert.toggle
      service_data:
        entity_id: alert.asthma_risk

  - entity: sensor.cold_flu_index_today #IQVIA
    card_mod:
      style: |
        :host {
          --paper-item-icon-color:
            {% set level = states('sensor.cold_flu_index_today')|float(0) %}
            {% if level < 2.5 %} var(--entity-ok-color)
            {% elif level < 4.9 %} var(--entity-minor-color)
            {% elif level < 7.3 %} var(--entity-warning-color)
            {% elif level < 9.7 %} var(--entity-severe-color)
            {% elif level >= 9.7 %} var(--entity-critical-color)
            {% else %} var(--state-icon-color);
            {% endif %}
          ;
        }
    tap_action:
      action: more-info
    double_tap_action:
      action: url
      url_path: !secret FLU_FORECAST
    hold_action:
      action: call-service
      service: alert.toggle
      service_data:
        entity_id: alert.flu_risk

  - entity: sensor.air_quality_index
    card_mod:
      style: |
        :host {
          --paper-item-icon-color:
            {% set level = states('sensor.air_quality_index')|float(0) %}
            {% if level < 51 %} var(--entity-ok-color)
            {% elif level < 101 %} var(--entity-minor-color)
            {% elif level < 151 %} var(--entity-severe-color)
            {% elif level < 201 %} var(--entity-critical-color)
            {% elif level < 301 %} rgb(142, 66, 149)
            {% elif level >= 301 %} rgb(124, 4, 37)
            {% else %} var(--state-icon-color)
            {% endif %}
          ;
        }
    tap_action:
      action: fire-dom-event
      browser_mod:
        command: popup
        deviceID: this
        large: true
        hide_header: true
        title: 'Air Quality Summary Graph'
        card: !include /config/lovelace/graph/weather/air_quality_detail_graph.yaml
    double_tap_action:
      action: url
      url_path: WAQI_STATUS
    hold_action:
      action: call-service
      service: alert.toggle
      service_data:
        entity_id: alert.air_quality

  - entity: sensor.uv_index
    card_mod:
      style: |
        :host {
          --paper-item-icon-color:
            {% set level = states('sensor.uv_index')|float(0) %}
            {% if level < 2.5 %} var(--entity-ok-color)
            {% elif level < 4.9 %} var(--entity-minor-color)
            {% elif level < 7.3 %} var(--entity-warning-color)
            {% elif level < 9.7 %} var(--entity-severe-color)
            {% else %} var(--entity-critical-color)
            {% endif %}
          ;
        }
    tap_action:
      action: fire-dom-event
      browser_mod:
        command: popup
        deviceID: this
        large: true
        hide_header: true
        title: 'Atmosphere Summary Graph'
        card: !include /config/lovelace/graph/weather/atmosphere_conditions_detail_graph.yaml
    double_tap_action:
      action: url
      url_path: !secret DARK_SKY_UV
    hold_action:
      action: call-service
      service: alert.toggle
      service_data:
        entity_id: alert.uv_risk

  - entity: sensor.climacell_fire_index
    icon: mdi:pine-tree-fire
    card_mod:
      style: |
        :host {
          --paper-item-icon-color:
            {% if states('sensor.climacell_fire_index')|int(0) > 80 %} var(--entity-critical-color)
            {% elif states('sensor.climacell_fire_index')|int(0) > 70 %} var(--entity-severe-color)
            {% elif states('sensor.climacell_fire_index')|int(0) > 60 %} var(--entity-warning-color)
            {% elif states('sensor.climacell_fire_index')|int(0) > 40 %} var(--entity-minor-color)
            {% else %} var(--entity-ok-color)
            {% endif %}
          ;
        }
    tap_action:
      action: more-info
    double_tap_action:
      action: url
      url_path: !secret ONT_FIRE
card_mod:
  class: sub_card
