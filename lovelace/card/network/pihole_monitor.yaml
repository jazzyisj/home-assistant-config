###############################################################################
## Pi-Hole Monitor
###############################################################################
type: entities
title: 'Pi-Hole Monitor'
icon: mdi:pi-hole
state_color: true
show_header_toggle: false
entities:
  - entity: binary_sensor.pi_hole
    tap_action:
      action: more-info
    double_tap_action:
      action: url
      url_path: !secret PIHOLE_ADMIN
    card_mod:
      style: |
        :host {
          --paper-item-icon-color:
            {% if is_state('sensor.pi_hole_status','Disconnected') %} var(--entity-critical-color)
            {% elif is_state('sensor.pi_hole_status','Disabled') %} var(--entity-warning-color)
            {% else %} var(--entity-critical-color)
            {% endif %}
          ;
          --paper-item-icon-active-color: var(--entity-ok-color) ;
        }

  - entity: sensor.pi_hole_status
    tap_action:
      action: url
      url_path: !secret PIHOLE_ADMIN
    card_mod:
      style: |
        :host {
          --paper-item-icon-color:
            {% if is_state('sensor.pi_hole_status','Enabled') %} var(--entity-ok-color)
            {% else %} var(--entity-severe-color)
            {% endif %}
          ;
        }

  - entity: sensor.pi_hole_seen_clients
    card_mod:
      style: |
        :host {
          --paper-item-icon-color:
            {% if is_number(states('sensor.pi_hole_seen_clients')) %} var(--entity-ok-color)
            {% else %} var(--entity-severe-color)
            {% endif %}
          ;
        }

  - entity: sensor.pi_hole_domains_blocked
    card_mod:
      style: |
        :host {
          --paper-item-icon-color:
            {% if is_number(states('sensor.pi_hole_domains_blocked')) %} var(--entity-ok-color)
            {% else %} var(--entity-severe-color)
            {% endif %}
          ;
        }

  - type: custom:fold-entity-row
    padding: 5
    head:
      entity: sensor.pi_hole_ads_percentage_blocked_today
      card_mod:
        style: |
          :host {
            --paper-item-icon-color:
              {% if is_number(states('sensor.pi_hole_ads_percentage_blocked_today')) %} var(--entity-ok-color)
              {% else %} var(--entity-severe-color)
              {% endif %}
            ;
          }
    entities:
      - entity: sensor.pi_hole_ads_blocked_today
      - entity: sensor.pi_hole_dns_queries_cached
      - entity: sensor.pi_hole_dns_queries_forwarded
      - entity: sensor.pi_hole_dns_queries_today
      - entity: sensor.pi_hole_dns_unique_clients
      - entity: sensor.pi_hole_dns_unique_domains

  - entity: input_number.pi_hole_disable_time

  - type: buttons
    entities:
      - entity: binary_sensor.pi_hole
        name: 'Pi-Hole Admin'
        tap_action:
          action: url
          url_path: !secret PIHOLE_ADMIN #ISSUE only works on LAN, how to hide on WAN

      - entity: switch.pi_hole_enabled
        name: Enable Pi-Hole
    card_mod:
      style:
        hui-buttons-base $: |
          .ha-scrollbar {
            justify-content: center;
          }
card_mod:
  class: basic
  style: | #SWIPE
    ha-card {
        margin: 1%;
      }
