###############################################################################
## Kiosk Monitor
## https://github.com/cgarwood/homeassistant-fullykiosk
## https://github.com/thomasloven/hass-browser_mod
###############################################################################
type: entities
title: 'Kiosk Monitor'
icon: mdi:tablet-dashboard
show_header_toggle: false
state_color: true
entities:
  - entity: binary_sensor.kiosk_connected

  - type: custom:fold-entity-row
    head: binary_sensor.kiosk_motion
    entities:
      - entity: switch.fire_tablet_motion_detection

  - type: custom:fold-entity-row
    head: device_tracker.kiosk_tablet
    entities:
      - entity: sensor.fire_tablet_wifi_signal_level

  - type: custom:fold-entity-row
    head: light.fire_tablet_screen
    entities:
      - entity: binary_sensor.kiosk_screen
      - entity: number.fire_tablet_screen_off_timer
      - entity: switch.fire_tablet_screensaver
      - entity: number.fire_tablet_screensaver_brightness
      - entity: number.fire_tablet_screensaver_timer
      - entity: sensor.fire_tablet_screen_orientation

  - type: custom:fold-entity-row
    head: sensor.browser_kiosk_internal
    entities:
      - type: custom:template-entity-row
        entity: sensor.fire_tablet_current_page
        state: "{{ states('sensor.fire_tablet_current_page')|replace('http://192.168.1.100:8123/lovelace-kiosk/','') }}"

      - entity: sensor.fire_tablet_foreground_app
      - entity: button.fire_tablet_bring_to_foreground
      - entity: button.fire_tablet_load_start_url
      - entity: button.fire_tablet_restart_browser
      - entity: button.fire_tablet_send_to_background

  - type: custom:fold-entity-row
    head:
      type: custom:battery-state-entity
      entity: sensor.fire_tablet_battery_level
    entities:
      - entity: binary_sensor.fire_tablet_plugged_in

  - entity: media_player.kiosk_media_player

  - type: custom:fold-entity-row
    head: binary_sensor.fire_tablet_device_admin
    entities:
      - entity: binary_sensor.fire_tablet_kiosk_mode
      - entity: switch.fire_tablet_kiosk_lock
      - entity: switch.fire_tablet_maintenance_mode
      - entity: camera.browser_kiosk_internal
      - entity: media_player.fire_tablet_media_player
      - entity: sensor.fire_tablet_internal_storage_free_space
      - entity: sensor.fire_tablet_internal_storage_total_space
      - entity: sensor.fire_tablet_ram_free_memory
      - entity: sensor.fire_tablet_ram_total_memory
      - entity: sensor.fire_tablet_last_app_start
      - entity: button.fire_tablet_reboot_device

      - type: custom:auto-entities
        show_empty: true
        unique: true
        sort:
          method: name
        card:
          type: custom:fold-entity-row
          padding: 10
          head:
            type: custom:template-entity-row
            entity: binary_sensor.fire_tablet_device_admin
            name: 'Kiosk Automations'
            icon: mdi:sync-alert
            state: ''
            active: true
        filter:
          include:
            - domain: automation
              name: '*Kiosk*'

  - type: buttons
    entities:
      - entity: binary_sensor.kiosk_connected
        name: 'Kiosk Admin'
        tap_action:
          action: url
          url_path: !secret KIOSK_ADMIN
    card_mod:
      style:
        hui-buttons-base $: |
          .ha-scrollbar {
            justify-content: center;
          }
card_mod:
  class: basic
