###############################################################################
## Precipitation Summary Graph
# https://github.com/RomRider/apexcharts-card
# https://apexcharts.com/docs/installation/
###############################################################################
type: custom:apexcharts-card
config_templates: weather_graph_week
apex_config:
  title:
    text: 'Precipitation'
yaxis:
  - id: percent
    show: true
    min: 0
    max: 100
    apex_config:
      tickAmount: 5
      decimalsInFloat: 0
      labels:
        show: true
      title:
        text: 'Perecent'
        rotate: -90

  - id: pressure
    show: true
    opposite: true
    min: 1000
    max: 1035
    apex_config:
      tickAmount: 5
      decimalsInFloat: 0
      labels:
        show: true
        align: center
      title:
        text: 'Pressure'
        rotate: -90

  - id: intensity
    show: false
    min: 0
    max: 10
    apex_config:
      tickAmount: 5
      decimalsInFloat: 3

  - id: precip
    show: false
    min: 0
    max: 25
    apex_config:
      tickAmount: 5
      decimalsInFloat: 0
series:
  - name: 'Probability'
    entity: sensor.precipitation_probability
    yaxis_id: percent
    fill_raw: 'null'
    type: area
    stroke_width: 0
    color: rgb(255, 164, 79)
    color_threshold:
      - value: 0
        opacity: 0
      - value: 50
        opacity: 0.3
      - value: 70
        opacity: 0.4
      - value: 100
        opacity: 0.5

  - name: 'Intensity'
    entity: sensor.precipitation_intensity # https://www.windy.com/colors?rainAccu,42.505,-88.451,6
    yaxis_id: intensity
    float_precision: 3
    fill_raw: 'null'
    type: area
    stroke_width: 0
    opacity: 0.5
    color: rgb(235, 52, 177)
    color_threshold:
      - value: 0
        color: rgb(67, 87, 166)
        opacity: 1
      - value: 0.8
        color: rgb(70, 102, 163)
        opacity: 1
      - value: 2
        color: rgb(62, 171, 171)
        opacity: 1
      - value: 6
        color: rgb(62, 171, 171)
        opacity: 1
      - value: 8
        color: rgb(62, 142, 62)
        opacity: 1
      - value: 10
        color: rgb(129, 156, 62)
        opacity: 1
      - value: 15
        color: rgb(171, 171, 62)
        opacity: 1
      - value: 15
        color: rgb(171, 171, 62)
        opacity: 1
      - value: 20
        color: rgb(169, 62, 62)
        opacity: 1
      - value: 31
        color: rgb(171, 62, 171)
        opacity: 1
      - value: 50
        color: rgb(177, 177, 177)
        opacity: 1

  - name: 'Clouds'
    entity: sensor.cloud_cover
    yaxis_id: percent
    type: area
    stroke_width: 1
    color: rgb(128, 128, 128)
    opacity: 1
    color_threshold:
      - value: 0
        color: rgb(0, 122, 255)
        opacity: 0
      - value: 100
        color: rgb(128, 128, 128)
        opacity: 0.5

  - name: 'Humidity'
    entity: sensor.outdoor_humidity
    yaxis_id: percent
    color: rgb(52, 150, 235)

  - name: 'Pressure'
    entity: sensor.barometric_pressure
    yaxis_id: pressure
    float_precision: 0
    color: rgb(229, 235, 52)

  - name: 'Rain'
    entity: sensor.precipitation_yesterday_rain
    yaxis_id: precip
    type: column
    group_by:
      func: max
      duration: 24h
    show:
      datalabels: true
    stroke_width: 5
    color: rgb(0, 51, 255)

  - name: 'Snow'
    entity: sensor.precipitation_yesterday_snow
    yaxis_id: precip
    type: column
    group_by:
      func: max
      duration: 24h
    show:
      datalabels: true
    stroke_width: 5
    color: rgb(3, 252, 227)
