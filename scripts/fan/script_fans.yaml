###############################################################################
## Fans Off - Ceiling Fans Only
###############################################################################
fans_off:
  alias: 'Fans Off'
  description: 'Turn all ceiling fans off.'
  icon: mdi:fan-off
  sequence:
    - service: fan.turn_off
      target:
        entity_id: >
          {{ states.fan|selectattr('attributes.type','eq','ceiling_fan')
            |selectattr('state','eq','on')|map(attribute='entity_id')|list }}

###############################################################################
## Fans On - Ceiling Fans Only
###############################################################################
fans_on:
  alias: 'Fans On'
  description: 'Turn all ceiling fans on.'
  icon: mdi:fan
  sequence:
    - service: fan.turn_on
      target:
        #ZWAVE state on/off to ensure device ready (state on/off)
        entity_id: >
          {{ states.fan|selectattr('attributes.type','eq','ceiling_fan')
            |selectattr('state','in',['on','off'])|map(attribute='entity_id')|list }}
      data:
        percentage: 100
