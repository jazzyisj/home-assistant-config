###############################################################################
## Sump Error Notification
###############################################################################
sump_error_notification:
  alias: "Sump Error Notification"
  description: "Send notification of sump pump error."
  icon: mdi:pump-off
  mode: queued
  fields:
    sump:
      description: "Sump pump name."
      example: "indoor"
  sequence:
    - service: notify.jason
      data:
        title: "{{ sump|title }} Sump Error"
        message: >
          {% if not has_value('switch.' ~ sump ~ '_sump') %}
            The {{ sump }} sump switch is disconnected.
          {% elif sump == 'outdoor' and is_number(states('sensor.outdoor_temperature')) %}
            Check the outdoor sump pump.  The outdoor temperature is unknown.
            <br>Outdoor Sump: {{ states('switch.outdoor_sump')|upper }}
            Outdoor Temp: {{ states('sensor.outdoor_temperature') }}
          {% else %} ERROR
          {% endif %}
        data:
          tag: "{{ sump }}_sump_error"
          group: General
          channel: Alert
          importance: max
          ttl: 0
          priority: high
          visibility: public
          notification_icon: mdi:pump-off
          icon_url: !secret ALERT_ICON
          ledColor: !secret WARNING_COLOR
          color: !secret WARNING_COLOR
          vibrationPattern: !secret ALERT_VIBRATION
          clickAction: /ui-mobile/home
          actions:
            - title: "Sump On"
              action: "turn_{{ sump }}_sump_on"

            - title: "Sump Off"
              action: "turn_{{ sump }}_sump_off"
