#######################################################################################################################
## Reminders Off
#######################################################################################################################
reminders_off:
  alias: "Reminders Off"
  description: "Turn off active reminder switches."
  icon: mdi:reminder
  variables:
    reminders: "{{ ['dexter_medication','maddie_mealtime','jason_medication','hot_tub_maintenance'] }}"
  sequence:
    - repeat:
        count: "{{ reminders|count }}"
        sequence:
          - variables:
              reminder: "{{ reminders[repeat.index-1] }}"

          - choose:
            - conditions: "{{ is_state('input_boolean.' ~ reminder ~ '_active','on') }}"
              sequence:
                - service: input_boolean.turn_off
                  target:
                    entity_id: "input_boolean.{{ reminder }}_active"

                - service: script.tts_play
                  data:
                    message: >
                      {% if reminder == 'dexter_medication' %} Dexter's medication
                      {% elif reminder == 'maddie_mealtime' %} Maddie's mealtime
                      {% elif reminder == 'jason_medication' %} Jason's medication
                      {% elif reminder == 'hottub_maintenance' %} The hot tub maintenance
                      {% endif %} reminder has been turned off.
                    quiet_play: true
