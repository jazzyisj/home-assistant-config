###############################################################################
## Weather Report
###############################################################################
weather_report:
  alias: "Weather Report"
  description: "Play daily weather report."
  icon: mdi:weather-partly-lightning
  max_exceeded: silent
  sequence:
    - if: >
        {{ is_state('binary_sensor.pirateweather_integration_connected', 'off')
            or is_state('binary_sensor.weatherflow_local_integration_connected', 'off')
            or is_state('binary_sensor.envcan_integration_connected', 'off') }}
      then:
        - action: script.tts_play
          data:
            provider: "HASS Cloud"
            language: "English (USA)"
            voice: "Brandon"
            always_play: true
            save_message: false
            message: "The weather forecast cannot play. One or more required weather providers is not connected."

        - action: system_log.write
          data:
            logger: "{{ this.entity_id }}"
            level: warning
            message: "Weather provider not connected."

        - stop: "Weather provider not connected."

    - action: script.tts_play
      data:
        media_player: media_player.inside_speakers
        min_volume: 40
        provider: "HASS Cloud"
        language: "English (Ireland)"
        voice: "Emily"
        always_play: true
        save_message: false
        message: !include /config/include/weather_report.yaml
