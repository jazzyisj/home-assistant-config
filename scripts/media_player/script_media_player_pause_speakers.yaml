#######################################################################################################################
## Pause Speaker Media Players
#######################################################################################################################
pause_media_players_speaker:
  alias: Pause Media Players Speaker
  description: Pause all speaker media players.
  icon: mdi:play-box-multiple-outline
  mode: restart
  variables:
    players: "{{ expand('group.media_players')|selectattr('attributes.device_class','eq','speaker')|selectattr('state','eq','playing')|map(attribute='entity_id')|list }}"
  sequence:
    # check if any media players are playing
    - condition: template
      value_template: "{{ players|count > 0 }}"

    # pause any playing media players
    - service: media_player.media_pause
      data:
        entity_id: "{{ players }}"