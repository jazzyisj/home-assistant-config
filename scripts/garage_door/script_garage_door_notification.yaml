###############################################################################
## Garage Door Notification
###############################################################################
garage_door_notification:
  alias: "Garage Door Notification"
  description: "Send garage door alert notification."
  icon: mdi:garage-alert
  fields:
    error:
      description: "Garage door error type."
      example: "open"
    message:
      description: "Garage door alert message."
      example: "Garage door open"
    person:
      description: "Person to notify."
      example: "jason"
  sequence:
    - variables: #TEMP side_door until garage_inside replaced
        url: "{% from 'file.jinja' import snapshot_filename %}{{ snapshot_filename('alarm_snapshots','side_door') }}"

    - service: camera.snapshot
      target:
        entity_id: camera.side_door_frigate
      data:
        filename: "/config/www{{ url }}"

    - service: "notify.{{ person }}"
      data:
        title: Garage Door
        message: "{{ message }}"
        data:
          subject: "Garage Door {{ error|title }}!"
          tag: garage_door_alert
          group: Alert
          channel: Alert
          importance: max
          ttl: 0
          priority: high
          visibility: public
          persistent: true
          sticky: true
          notification_icon: mdi:garage-alert
          icon_url: !secret HASS_ICON
          image: "/local{{ url }}"
          ledColor: !secret WARNING_COLOR
          color: !secret WARNING_COLOR
          vibrationPattern: !secret ALERT_VIBRATION
          clickAction: /ui-mobile/garage
          actions:
            - title: "Alarm"
              action: URI
              uri: !secret ALARM_URI

            - title: "MyQ"
              action: URI
              uri: !secret MYQ_URI

            - title: "Alert Off"
              action: turn_off_garage_door_alert
