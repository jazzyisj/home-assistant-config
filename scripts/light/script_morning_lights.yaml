###############################################################################
## Morning Lights
###############################################################################
morning_lights:
  alias: 'Morning Lights'
  description: 'Adjust lighting to morning settings.'
  icon: mdi:home-lightbulb-outline
  sequence:
    # turn lights on minimum so we can transition up
    - choose:
        - conditions:
            - condition: state
              entity_id: timer.dining_room_light
              state: idle
          sequence:
            - service: light.turn_on
              target:
                entity_id: light.dining_room_rgb_light
              data:
                brightness: 5
                transition: 0

    - choose:
        - conditions:
            - condition: state
              entity_id: timer.living_room_light
              state: idle
          sequence:
            - service: light.turn_on
              target:
                entity_id: light.living_room_rgb_light
              data:
                brightness: 20
                transition: 0

    - choose:
        - conditions:
            - condition: state
              entity_id: timer.kitchen_potlights
              state: idle
          sequence:
            - service: light.turn_on
              target:
                entity_id: light.kitchen_potlights
              data:
                brightness: 10
                transition: 0

    - choose:
        - conditions:
            - condition: state
              entity_id: timer.hallway_potlights
              state: idle
          sequence:
            - service: light.turn_on
              target:
                entity_id: light.hallway_potlights
              data:
                brightness: 5
                transition: 0

    - delay: 5 # allow lights to turn on dim

    # start first lighting sequence
    - choose:
        - conditions:
            - condition: state
              entity_id: timer.living_room_light
              state: idle
          sequence:
            - service: light.turn_on
              target:
                entity_id: light.living_room_rgb_light
              data:
                brightness: 40
                transition: 900

    - choose:
        - conditions:
            - condition: state
              entity_id: timer.dining_room_light
              state: idle
          sequence:
            - service: light.turn_on
              target:
                entity_id: light.dining_room_rgb_light
              data:
                brightness: 75
                transition: 300

    - choose:
        - conditions:
            - condition: state
              entity_id: timer.kitchen_potlights
              state: idle
          sequence:
            - service: light.turn_on
              target:
                entity_id: light.kitchen_potlights
              data:
                brightness: 20
                transition: 900

    - choose:
        - conditions:
            - condition: state
              entity_id: timer.hallway_potlights
              state: idle
          sequence:
            - service: light.turn_on
              target:
                entity_id: light.hallway_potlights
              data:
                brightness: 20
                transition: 900

    # delay for transitions before next lighting sequence
    - delay: 900

    - choose:
        - conditions:
            - condition: state
              entity_id: timer.living_room_light
              state: idle
          sequence:
            - service: light.turn_on
              target:
                entity_id: light.living_room_rgb_light
              data:
                brightness: 5
                transition: 0

    - delay: 5

    # start second lighting sequence
    - choose:
        - conditions:
            - condition: state
              entity_id: timer.living_room_light
              state: idle
          sequence:
            - service: light.turn_on
              target:
                entity_id: light.living_room_rgb_light
              data:
                brightness: 50
                transition: 900

    - choose:
        - conditions:
            - condition: state
              entity_id: timer.dining_room_light
              state: idle
          sequence:
            - service: light.turn_on
              target:
                entity_id: light.dining_room_rgb_light
              data:
                brightness: 150
                transition: 900

    - choose:
        - conditions:
            - condition: state
              entity_id: timer.kitchen_potlights
              state: idle
          sequence:
            - service: light.turn_on
              target:
                entity_id: light.kitchen_potlights
              data:
                brightness: 50
                transition: 900

    - choose:
        - conditions:
            - condition: state
              entity_id: timer.hallway_potlights
              state: idle
          sequence:
            - service: light.turn_on
              target:
                entity_id: light.hallway_potlights
              data:
                brightness: 50
                transition: 900

    - choose:
        - conditions:
            - condition: state
              entity_id: timer.bedroom_light
              state: idle
          sequence:
            # turn lights on low so we can transition up
            - service: light.turn_on
              target:
                entity_id: light.bedroom_light
              data:
                brightness: 1
                transition: 0

            - service: light.turn_on
              target:
                entity_id: light.bedroom_light
              data:
                brightness: 50
                transition: 600

    - choose:
        - conditions:
            - condition: state
              entity_id: timer.office_potlights
              state: idle

            - condition: state
              entity_id: binary_sensor.work_today
              state: 'on'
          sequence:
            - service: light.turn_on
              target:
                entity_id: light.office_potlights
              data:
                brightness: 255
                transition: 0

    - service: light.turn_on
      target:
        entity_id: light.kitchen_sink_light

    # keep on to delay auto lights at least 15 minutes
    - delay:
        minutes: 15

    # keep on until wake up is done
    - wait_template: "{{ is_state('script.waketime','off') }}"
      timeout:
        minutes: 60
