#######################################################################################################################
## Bedtime Notification
#######################################################################################################################
bedtime_notification:
  alias: Bedtime Notification
  description: Bedtime lights, night mode.
  icon: mdi:bed-empty
  mode: single
  sequence:
    - choose:
        - conditions:
            - condition: state
              entity_id: binary_sensor.alerts_enabled
              state: 'on'

          sequence:
            - service: >
                {% if is_state('binary_sensor.jason_home','on')
                     and is_state('binary_sensor.sheri_home','on') %} notify.mobile
                {% elif is_state('binary_sensor.jason_home','on') %} notify.mobile_app_jphone
                {% elif is_state('binary_sensor.sheri_home','on') %} notify.mobile_app_sphone
                {% endif %}
              data:
                title: Bedtime
                message: |
                  It's time for bed!
                  Turn on Bedtime Delay to push off your bedtime for {{ states('input_number.stay_awake_delay')|int }} minutes.
                data:
                  tag: bedtime_notice
                  group: General
                  channel: Alert
                  importance: high
                  vibrationPattern: '100, 100, 100'
                  ledColor: !secret NOTIFY_COLOR
                  priority: high
                  ttl: 0
                  timeout: 900
                  persistent: false
                  sticky: false
                  color: !secret NOTIFY_COLOR
                  icon_url: !secret HASSIO_ICON
                  actions:
                    - action: bedtime_delayed
                      title: Bedtime Delay