#######################################################################################################################
## Close Notifications
#######################################################################################################################
close_notifications:
  alias: Close Notifications
  description: Dismiss notifications on all devices.
  icon: mdi:close-box-multiple
  mode: queued
  fields:
    target:
      description: Notifier target name.
      example: everyone
    tag:
      description: Notification tag.
      example: phone_battery_jason
    pause:
      description: True if triggered by pause action.
      example: true
  sequence:
    # turn off alert if pause is true
    - choose:
        - conditions:
            - condition: template
              value_template: "{{ pause }}"

          sequence:
            - service: alert.turn_off
              data:
                entity_id: "alert.{{ tag }}"

    - service: persistent_notification.dismiss
      data:
        notification_id: "{{ tag }}"

    - service: "notify.{{ target }}"
      data:
        message: clear_notification
        data:
          tag: "{{ tag }}"