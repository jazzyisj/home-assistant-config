adaptive_lighting_change_sunlight_settings:
  alias: 'Adaptive Lighting - Change Sunlight Settings'
  fields:
    use_config_defaults:
      description: ''
    max_brightness:
      description: ''
    max_color_temp:
      description: ''
    min_brightness:
      description: ''
    min_color_temp:
      description: ''
    sleep_brightness:
      description: ''
    sleep_color_temp:
      description: ''
    sunrise_offset:
      description: ''
    sunrise_time:
      description: ''
    sunset_offset:
      description: ''
    sunset_time:
      description: ''
    transition:
      description: ''
  variables:
    use_config_defaults: "{{ use_config_defaults|default('off') }}"
    use_actual_sunrise_time: "{{ 'off' if sunrise_time == empty else 'on' }}"
    use_actual_sunset_time: "{{ 'off' if sunset_time == empty else 'on' }}"
    max_brightness: "{{ max_brightness|default('') }}"
    max_color_temp: "{{ max_color_temp|default('') }}"
    min_brightness: "{{ min_brightness|default('') }}"
    min_color_temp: "{{ min_color_temp|default('') }}"
    sleep_brightness: "{{ sleep_brightness|default('') }}"
    sleep_color_temp: "{{ sleep_color_temp|default('') }}"
    sunrise_offset: "{{ sunrise_offset|default('') }}"
    sunrise_time: "{{ sunrise_time|default('') }}"
    sunset_offset: "{{ sunset_offset|default('') }}"
    sunset_time: "{{ sunset_time|default('') }}"
    transition: "{{ transition|default('') }}"
    options: >
      {% set option_dict = namespace(value='') %}
      {% set options = ['use_config_defaults','use_actual_sunrise_time','use_actual_sunset_time',
          'max_brightness','max_color_temp','min_brightness','min_color_temp','sleep_brightness',
          'sleep_color_temp','sunrise_offset','sunrise_time','sunset_offset','sunset_time','transition'] %}
      {% set values = [use_config_defaults,use_actual_sunrise_time,use_actual_sunset_time,
          max_brightness,max_color_temp,min_brightness,min_color_temp,sleep_brightness,
          sleep_color_temp,sunrise_offset,sunrise_time,sunset_offset,sunset_time,transition] %}
      {% for item in options %}
        {% if values[loop.index0] != '' %}
          {% set option_dict.value = option_dict.value
              ~ '"' ~ item ~ '":"'
              ~ values[loop.index0] ~ '"' ~ ',' %}
        {% endif %}
      {% endfor %}
      {{ '{' ~ option_dict.value[:-1] ~ '}' }}
  sequence:
    # you can delete this when done debuggin
    - service: system_log.write
      data:
        message: '{{ options }}'

    # - service: adaptive_lighting.change_sunlight_settings
    #   data: '{{ options }}'
