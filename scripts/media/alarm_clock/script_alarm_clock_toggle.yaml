#######################################################################################################################
## Alarm Clock Toggle
#######################################################################################################################
alarm_clock_toggle:
  alias: Alarm Clock Toggle
  description: "Toggle alarm clock state."
  max_exceeded: silent
  fields:
    alarm_type:
      description: Alarm type to play (auto, manual, nap).
      example: nap
    test_play:
      description: User is test playing alarm.
      example: 'true'
  variables:
    first_run: "{{ first_run|default(false) }}"
    test_play: "{{ test_play|default(false) }}"
  sequence:
    - choose:
        - conditions: "{{ is_state('switch.alarm_clock_' ~ alarm_type,'off') }}"
          sequence:
            - choose:
                - conditions: "{{ test_play }}"
                  sequence:
                    - service: input_boolean.turn_on
                      target:
                        entity_id: input_boolean.alarm_clock_test_play

            - service: switch.turn_on
              target:
                entity_id: "switch.alarm_clock_{{ alarm_type }}"
      default:
        - service: switch.turn_off
          target:
            entity_id: "switch.alarm_clock_{{ alarm_type }}"
