cast_front_door_camera:
  alias: "Cast Front Door Camera"
  max_exceeded: silent
  sequence:
    - enabled: false #TEMP cuts out playing media
      service: cast.show_lovelace_view
      data:
        dashboard_path: lovelace-cast
        entity_id: media_player.dining_room_hub
        view_path: front_door

    - enabled: false #TEMP cuts out playing media
      service: cast.show_lovelace_view
      data:
        dashboard_path: lovelace-cast
        entity_id: media_player.bedroom_hub
        view_path: front_door

    # turn kiosk screen on, turn off screensaver
    - service: light.turn_on
      target:
        entity_id: light.fire_tablet_screen

    - service: switch.turn_off
      target:
        entity_id: switch.fire_tablet_screensaver

    - service: button.press
      target:
        entity_id: button.fire_tablet_bring_to_foreground

    - service: browser_mod.popup
      data:
        deviceID: browser_kiosk_internal
        large: true
        title: "Front Door"
        hide_header: true
        card: !include /config/lovelace/card/camera/front_door_frigate_camera.yaml

    - delay: 60

    - wait_template: "{{ is_state('binary_sensor.camera_person_detected','off') }}"
      timeout: 300

    - service: browser_mod.close_popup #ISSUE closes all popups on all devices

    # stop casting
    - enabled: false #TEMP cuts out playing media
      service: media_player.turn_off
      target:
        entity_id:
          - media_player.dining_room_hub
          - media_player.bedroom_hub
