# true if trigger is the current alarm_clock media player or in alarm clock speaker group
condition: template
value_template: >
  {% set alarm = states('sensor.alarm_clock_media_player') %}
  {% if alarm in state_attr('group.google_speaker_groups','entity_id') %}
    {% set found = namespace(value=0) %}
    {% for alarm_player in state_attr('group.' ~ alarm.split('.')[1],'entity_id') %}
      {% if trigger.entity_id == alarm_player %}{% set found.value = 1 %}{% endif %}
    {% endfor %}
    {{ found.value|int == 1 }}
  {% else %}{{ trigger.entity_id == alarm }}
  {% endif %}