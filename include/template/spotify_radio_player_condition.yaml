#######################################################################################################################
## Spotify - Radio Player Condition
# false if radio not playing
# true if spotify media player (or group memeber) is a radio media player (or group member)
#######################################################################################################################
condition: template
value_template: >
  {% if is_state('binary_sensor.radio_on','off') %} false
  {% else %}
    {% set spotify = states('sensor.spotify_media_player') %}
    {% set radio = states('sensor.radio_media_player') %}
    {% set groups = state_attr('group.google_speaker_groups','entity_id') %}
    {% set found = namespace(value=0) %}
    {% if spotify in groups %}
      {% for spotify_player in state_attr('group.' ~ spotify.split('.')[1], 'entity_id') %}
        {% if radio in groups %}
          {% for radio_player in state_attr('group.' ~ radio.split('.')[1], 'entity_id') %}
            {% if spotify_player == radio_player %}{% set found.value = 1 %}{% endif %}
          {% endfor %}
        {% elif spotify_player == radio %}
          {% set found.value = 1 %}
        {% endif %}
      {% endfor %}
    {% else %}
      {% if radio in groups %}
        {% for radio_player in state_attr('group.' ~ radio.split('.')[1], 'entity_id') %}
          {% if spotify == radio_player %}{% set found.value = 1 %}{% endif %}
        {% endfor %}
      {% elif spotify == radio %}
        {% set found.value = 1 %}
      {% endif %}
    {% endif %}
    {{ found.value|int == 1 }}
  {% endif %}