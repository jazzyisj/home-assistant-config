#######################################################################################################################
## Radio - Not TTS Condition
# if annoucenement is playing then trigger is not announcement media player (or in announcement speaker group)
#######################################################################################################################
condition: template
value_template: >
  {% set tts = states('sensor.tts_media_player') %}
  {% if is_state('binary_sensor.tts_playing','off') %} true
  {% else %}
    {% if is_state_attr(tts,'speaker_group',true) %}
      {% set found = namespace(value=0) %}
      {% set tts_group = states.media_player|selectattr('attributes.' ~ tts.split('.')[1],'eq',true)|map(attribute='entity_id')|list %}
      {% for tts_player in tts_group %}
        {% if trigger.entity_id == tts_player %}{% set found.value = 1 %}{% endif %}
      {% endfor %}
      {{ found.value|int == 0 }}
    {% else %}{{ trigger.entity_id != tts }}
    {% endif %}
  {% endif %}