#######################################################################################################################
## Alert - Unavailable Sensor
#######################################################################################################################
system_unavailable_sensor:
  name: Unavailable Sensor
  title: Unavailable Sensors #VERIRY
  message: >
    {%- if states.sensor.unavailable_sensors.attributes.entities is defined -%}
      {%- if states('sensor.unavailable_sensors')|int == 0 -%}
        No unavailable entities.
      {%- else -%}
        {%- for device in state_attr('sensor.unavailable_sensors','entities') -%}
        - {{ state_attr(device,'friendly_name') }}{%- if not loop.last -%}<br>{%- endif -%}
        {%- endfor -%}
      {%- endif -%}
    {%- endif -%}
  entity_id: binary_sensor.unavailable_sensor_alert
  state: 'on'
  repeat: 1440
  can_acknowledge: true
  skip_first: false
  notifiers: mobile_app_jphone
  data:
    subject: There are unavailable sensors.
    tag: unavailable_sensor
    group: System
    channel: Alert
    importance: high
    vibrationPattern: '200, 200, 200, 200, 200, 200, 200'
    ledColor: !secret WARNING_COLOR
    priority: high
    ttl: 0
    timeout: 86400
    persistent: false
    sticky: false
    clickAction: /lovelace/system
    color: !secret WARNING_COLOR
    icon_url: !secret OFFLINE_ICON
    actions:
      - action: pause_unavailable_sensor
        title: Pause

