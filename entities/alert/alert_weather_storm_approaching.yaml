#######################################################################################################################
## Alert - Storm Approaching
#######################################################################################################################
weather_storm_approaching:
  name: Storm Approaching
  title: Storm Approaching
  message: >
    {%- if not states('sensor.dark_sky_nearest_storm_distance')|int == 0 -%}
      <p/>There is a {% if not states('sensor.dark_sky_precip') == 'unknown' %}{{ states('sensor.dark_sky_precip') }}{%- endif -%} storm {{ states('sensor.dark_sky_nearest_storm_distance') }}
      {{- ' mile ' if states('sensor.dark_sky_nearest_storm_distance')|int == 1 else ' miles ' -}} away,
      {%- if not states('sensor.storm_full_cardinal_direction') == 'unknown' -%} approaching from the {{ states('sensor.storm_full_cardinal_direction') }}{%- endif -%}.
    {%- else -%}There is a {% if not states('sensor.dark_sky_precip') == 'unknown' -%}
      {{- states('sensor.dark_sky_precip') }}{%- endif -%} storm in the immediate vicinity.
    {%- endif %}
    <p/>The current forecast is {{ states('sensor.dark_sky_minutely_summary')|replace('<',' less than ')|replace('>','greater than') }}
  entity_id: binary_sensor.storm_approaching_alert
  state: 'on'
  repeat: 1440
  can_acknowledge: true
  skip_first: true
  notifiers: mobile_app_jphone
  data:
    tag: storm_approaching
    group: Alert
    channel: General
    importance: high
    vibrationPattern: '200, 200, 200, 200, 200, 200, 200'
    ledColor: !secret WARNING_COLOR
    priority: high
    ttl: 0
    timeout: 3600
    persistent: false
    sticky: false
    clickAction: /lovelace/weather
    color: !secret WARNING_COLOR
    icon_url: !secret STORM_ICON
    image: !secret STORM_IMAGE
    actions:
      - action: pause_storm_approaching
        title: Pause

