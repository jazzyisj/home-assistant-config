###############################################################################
## Enviroment Canada Weather Package
## https://www.home-assistant.io/integrations/environment_canada/
## severity values: warning, watch, advisory, statement
###############################################################################
homeassistant:
  customize:
    alert.envcan_alert:
      friendly_name: "EnvCan Alert"
      icon: mdi:weather-hurricane
      category: weather

    camera.envcan_radar:
      control: hidden

#DISABLED weather: #BUG enabled causing envcan sensors to stop updating?
#   - platform: environment_canada
#     name: "EnvCan Daily"
#     latitude: !secret HOME_LAT
#     longitude: !secret HOME_LONG
#     forecast: daily

#   - platform: environment_canada
#     name: "EnvCan Hourly"
#     latitude: !secret HOME_LAT
#     longitude: !secret HOME_LONG
#     forecast: hourly

camera:
  - platform: environment_canada
    name: "EnvCan Radar"
    latitude: !secret HOME_LAT
    longitude: !secret HOME_LONG
    loop: true

input_select:
  previous_envcan_alert_severity:
    name: "Previous EnvCan Alert Severity"
    options:
      - watch
      - warning
      - advisory
      - statement
      - cleared

input_text:
  previous_envcan_alert_title:

sensor:
  - platform: environment_canada
    latitude: !secret HOME_LAT
    longitude: !secret HOME_LONG

alert:
  envcan_alert:
    name: "Envcan Alert"
    title: "EnvCan Weather Alert"
    message: | #DARKSKY
      {{ state_attr('binary_sensor.envcan_weather_alert','title') }}
      {{ state_attr('binary_sensor.envcan_weather_alert','description') }}
    done_message: clear_notification
    entity_id: binary_sensor.envcan_weather_alert
    state: 'on'
    repeat: 720
    notifiers: mobile
    data:
      tag: envcan_alert
      group: General
      channel: Alert
      importance: max
      ttl: 0
      priority: high
      clickAction: /lovelace/weather
      color: !secret WEATHER_COLOR
      icon_url: !secret STORM_ICON



