###############################################################################
## Package - Weatherflow
## https://weatherflow.com/tempest-weather-system/
###############################################################################

weather:
  - platform: template
    name: 'WeatherFlow Local Daily'
    unique_id: weatherflow_local_daily
    condition_template: "{{ states('sensor.hub_hb_00073766_weather') }}"
    temperature_template: >
      {% if is_number(states('sensor.tempest_st_00057689_temperature')) %}
        {{ states('sensor.tempest_st_00057689_temperature')|float }}
      {% endif %}
    humidity_template: >
      {% if is_number(states('sensor.tempest_st_00057689_humidity')) %}
        {{ states('sensor.tempest_st_00057689_humidity')|int }}
      {% endif %}
    pressure_template: >
      {% if is_number(states('sensor.tempest_st_00057689_sea_level_pressure')) %}
        {{ states('sensor.tempest_st_00057689_sea_level_pressure')|float }}
      {% endif %}
    wind_speed_template: >
      {% if is_number(states('sensor.tempest_st_00057689_wind_speed_avg')) %}
        {{ (states('sensor.tempest_st_00057689_wind_speed_avg')|float * 3.6)|round(1) }} # km/h
      {% endif %}
    wind_bearing_template: >
      {% if is_number(states('sensor.tempest_st_00057689_wind_bearing_avg')) %}
        {{ states('sensor.tempest_st_00057689_wind_bearing_avg')|int }}
      {% endif %}
    visibility_template: >
      {% if is_number(states('sensor.tempest_st_00057689_visibility')) %}
        {{ states('sensor.tempest_st_00057689_visibility')|float }}
      {% endif %}
    forecast_template: "{{ state_attr('sensor.hub_hb_00073766_weather','daily_forecast') }}"
    attribution_template: "{{ state_attr('sensor.hub_hb_00073766_weather','attribution') }}"

  - platform: template
    name: 'WeatherFlow Local Hourly'
    unique_id: weatherflow_local_hourly
    condition_template: "{{ states('sensor.hub_hb_00073766_weather') }}"
    temperature_template: >
      {% if is_number(states('sensor.tempest_st_00057689_temperature')) %}
        {{ states('sensor.tempest_st_00057689_temperature')|float }}
      {% endif %}
    humidity_template: >
      {% if is_number(states('sensor.tempest_st_00057689_humidity')) %}
        {{ states('sensor.tempest_st_00057689_humidity')|int }}
      {% endif %}
    pressure_template: >
      {% if is_number(states('sensor.tempest_st_00057689_sea_level_pressure')) %}
        {{ states('sensor.tempest_st_00057689_sea_level_pressure')|float }}
      {% endif %}
    wind_speed_template: >
      {% if is_number(states('sensor.tempest_st_00057689_wind_speed_avg')) %}
        {{ (states('sensor.tempest_st_00057689_wind_speed_avg')|float * 3.6)|round(1) }} # km/h
      {% endif %}
    wind_bearing_template: >
      {% if is_number(states('sensor.tempest_st_00057689_wind_bearing_avg')) %}
        {{ states('sensor.tempest_st_00057689_wind_bearing_avg')|int }}
      {% endif %}
    visibility_template: >
      {% if is_number(states('sensor.tempest_st_00057689_visibility')) %}
        {{ states('sensor.tempest_st_00057689_visibility')|float }}
      {% endif %}
    forecast_template: "{{ state_attr('sensor.hub_hb_00073766_weather','hourly_forecast') }}"
    attribution_template: "{{ state_attr('sensor.hub_hb_00073766_weather','attribution') }}"
