{% macro twelve_hour(entity) %}
{{ states(entity)|as_timestamp(none)|timestamp_custom('%-I:%M %p',true,none) }}
{% endmacro %}

{% macro cardinal_direction(bearing) %}
{% set directions = ['North','North-Northeast','Northeast','East-Northeast','East','East-Southeast',
    'Southeast','South-Southeast','South','South-Southwest','Southwest','West-Southwest','West',
    'West-Northwest','Northwest','North-Northwest','North'] %}
{{ iif(is_number(bearing),directions[((bearing|float(-1)/360)|float*16)|round],'unknown') }}
{% endmacro %}

{% macro clist_locks(locks) %}
{%- set msg = namespace(value='') %}
{%- set qty = namespace(value=0) %}
{%- for item in locks %}
{%- set qty.value = qty.value|int(0) + 1 %}
{%- if not loop.first %}{% set msg.value = msg.value ~ ', ' %}{% endif %}
{%- set msg.value = msg.value ~ item.split('.')[1]|replace('_door_lock','')|replace('_',' ')|title %}
{%- endfor %}
{%- set clist = ', and ' if msg.value.split(', ')|count > 2 else ' and ' %}
{%- set plural = 's have' if qty.value|int(0) > 1 else ' has' %}
{{ clist.join(msg.value.rsplit(', ', 1)) }}
{% endmacro %}