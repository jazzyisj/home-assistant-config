###############################################################################
## ZWave - Ping Dead ZWave Devices
###############################################################################
- id: zwave_ping_dead_devices
  alias: "[ZWave] Ping Dead Devices"
  description: "Auto press ping button for dead zwave nodes."
  mode: queued
  trigger:
    - platform: state
      entity_id: sensor.offline_zwave_devices
      attribute: entity_id
      to: ~
  condition:
    - condition: template
      value_template: >
        {{ true if this.attributes.last_triggered == none
          else now() - this.attributes.last_triggered > timedelta(seconds=30) }}

    - condition: numeric_state
      entity_id: sensor.offline_zwave_devices
      above: 0
  action:
    - service: button.press
      target:
        entity_id: "{{ state_attr('sensor.offline_zwave_devices','entity_id') }}"
