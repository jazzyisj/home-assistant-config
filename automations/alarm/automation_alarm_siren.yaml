###############################################################################
## Alarm - Siren On
###############################################################################
- id: alarm_siren_on
  alias: "[Alarm] Siren Off"
  description: "Turn alarm siren on."
  trigger:
    - platform: state
      entity_id: alarm_control_panel.master
      to: triggered
  condition:
    - condition: state
      entity_id: input_boolean.alarm_enabled
      state: "on"
  action:
    - service: switch.turn_on
      target:
        entity_id:
          - switch.charlie_crate_camera_power
          - switch.living_room_camera_power

    - parallel:
        - sequence:
            - wait_template: "{{ has_value('siren.charlie_crate_camera_alarm') }}"
              timeout: 60
              continue_on_timeout: false

            - service: siren.turn_on
              target:
                entity_id: siren.charlie_crate_camera_alarm

        - sequence:
            - wait_template: "{{ has_value('siren.living_room_camera_alarm') }}"
              timeout: 60
              continue_on_timeout: false

            - service: siren.turn_on
              target:
                entity_id: siren.living_room_camera_alarm

###############################################################################
# Alarm - Siren Off
###############################################################################
- id: alarm_siren_off
  alias: "[Alarm] Siren Off"
  description: "Turn alarm siren off."
  trigger:
    - platform: state
      entity_id: alarm_control_panel.master
      to: disarmed
      from: triggered
  condition:
    - condition: state
      entity_id: input_boolean.alarm_enabled
      state: "on"
  action:
    - service: siren.turn_off
      target:
        entity_id:
          - siren.charlie_crate_camera_alarm
          - siren.living_room_camera_alarm
