###############################################################################
# Alarm - Pending Lights
###############################################################################
- id: alarm_pending_lights
  alias: "[Alarm] Pending Lights"
  description: "House alarm pending lighting."
  mode: queued
  trigger:
    - platform: state
      entity_id: input_boolean.alarm_pending
      to: "on"

    - platform: state
      entity_id: input_boolean.alarm_pending
      to: "off"
      for: 5 # allow alarm triggered to restore
  condition:
    - condition: state
      entity_id: input_boolean.alarm_enabled
      state: "on"
  action:
    - if:
        - condition: state
          entity_id: input_boolean.alarm_pending
          state: "on"
      then:
        - service: scene.create
          data:
            scene_id: alarm_pending_lights_restore
            snapshot_entities:
              - light.side_entrance_light
              - light.side_entrance_light
              - light.dining_room_potlights
              - light.hallway_potlights

        - delay: 1

        - service: script.light_scene_on
          data:
            scene: alarm_pending
      else:
        - delay: 15 # allow alarm triggered light restore

        - service: script.light_scene_on
          data:
            scene: alarm_pending_lights_restore
