#######################################################################################################################
## Alarm - Arm Away
#######################################################################################################################
- id: alarm_arm_away
  alias: "[Alarm] Arm Away"
  description: "Arm alarm in away mode."
  variables:
    override: "{{ trigger.event.data['action'] == 'arm_alarm_away_override' }}"
  trigger:
    - platform: event
      event_type: mobile_app_notification_action
      event_data:
        action: arm_alarm_away

    - platform: event
      event_type: mobile_app_notification_action
      event_data:
        action: arm_alarm_away_override
  condition:
    - condition: not
      conditions:
        - condition: state
          entity_id: alarm_control_panel.master
          state: armed_away

    - "{{ is_state('input_boolean.lock_automation','on') if trigger.id == 'lock_keypad' else true }}"
  action:
    - service: script.arm_alarm
      data:
        mode: away
        override: "{{ override|default(false) }}"
