##############################################################################
## Lock - Jammed Reset
###############################################################################
- id: lock_jammed_reset
  alias: "[Lock] Jammed Reset"
  description: "Reset jammed lock notification."
  max_exceeded: silent
  mode: queued
  trigger:
    - platform: event
      id: action
      event_type: mobile_app_notification_action
      event_data:
        action: reset_door_lock_jammed

    - platform: state
      id: lock
      entity_id:
        - lock.back_door_lock
        - lock.front_door_lock
        - lock.garage_door_lock
        - lock.side_door_lock
      to: locked
  condition:
    - condition: state
      entity_id:
        - input_boolean.back_door_lock_jammed
        - input_boolean.front_door_lock_jammed
        - input_boolean.garage_door_lock_jammed
        - input_boolean.side_door_lock_jammed
      match: any
      state: "on"
  action:
    - if: "{{ trigger.id == 'lock' }}"
      then:
        - service: input_boolean.turn_off
          target:
            entity_id: "input_boolean.{{ trigger.entity_id.split('.')[1] }}_jammed"
      else:
        - service: input_boolean.turn_off
          target:
            entity_id:
              - input_boolean.back_door_lock_jammed
              - input_boolean.front_door_lock_jammed
              - input_boolean.garage_door_lock_jammed
              - input_boolean.side_door_lock_jammed
