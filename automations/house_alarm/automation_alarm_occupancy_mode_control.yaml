#######################################################################################################################
## Alarm Occupancy Mode Control
#######################################################################################################################
- id: alarm_occupancy_mode_control
  alias: "[Alarm] Occupancy Mode Control"
  description: Arm alarm when occupancy mode changes.
  initial_state: true
  mode: restart
  trigger:
    # alarm state is not changed for Home/Guest
    - platform: state
      entity_id: input_select.occupancy_mode
      to:
        - Night
        - Away
        - Vacation

  condition:
    - condition: state
      entity_id:
        - input_boolean.alarm_automation
        - input_boolean.presence_automation
        - input_boolean.alarm_auto_arming
      state: 'on'

  action:
    - choose:
        - conditions:
            - condition: state
              entity_id: input_select.occupancy_mode
              state: Night

          sequence:
            - service: script.turn_on
              entity_id: script.arm_alarm_night

      default:
        - service: script.turn_on
          entity_id: script.arm_alarm_away