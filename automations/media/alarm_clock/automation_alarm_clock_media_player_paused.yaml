#######################################################################################################################
## Alarm Clock - Media Player Paused - allows use of media player pause as a snooze button
#######################################################################################################################
- id: alarm_clock_media_player_paused
  alias: "[Alarm Clock] Media Player Paused"
  description: "Detect alarm snooze (media player pause) and turn on snooze boolean."
  initial_state: true
  trigger:
    #NOTE alarm clock will snooze/fail if active and external source plays (eg launching spotify using google assistant)
    # no fix - can't prevent external from playing on alarm clock media players
    # no idea why it triggers pause instead of turning media player off
    # will snooze if paused, turns off alarm clock when turned off
    - platform: state
      entity_id: !include /config/include/entities/media_player_entities_single.yaml
      to: paused
      for: 5 #BUGFIX - allow new source to play and act as alarm clock
  condition:
    - condition: state
      entity_id:
        - input_boolean.resume_alarm_clock # prevent alarm snoozing with tts
        - script.alarm_clock_play
        - script.alarm_clock_stop
      state: 'off'

    - !include /config/include/template/condition_alarm_clock_media_player.yaml
  action:
    - service: switch.turn_on
      target:
        entity_id: switch.alarm_clock_snooze
