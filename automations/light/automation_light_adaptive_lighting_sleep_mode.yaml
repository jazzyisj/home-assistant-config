###############################################################################
## Light - Adaptive Lighting Sleep Mode
###############################################################################
- id: light_adaptive_lighting_sleep_mode
  alias: "[Light] Adaptive Lighting Sleep Mode"
  description: "Turn on sleep mode lighting."
  trigger:
    - platform: state
      entity_id: input_select.occupancy_mode
      to: Night
      for:
        minutes: 5 # lights off, in bed

    - platform: state
      entity_id: input_select.occupancy_mode
      from: Night
  condition:
    - condition: state
      entity_id: switch.adaptive_lighting
      state: "on"

    - condition: state
      entity_id:
        - input_boolean.occupancy_override
        - input_boolean.alarm_triggered
      state: "off"
  action:
    - if:
        - condition: state
          entity_id: input_select.occupancy_mode
          state: Night
      then:
        - service: switch.turn_on
          target:
            entity_id: &sleep_lights
              - switch.adaptive_lighting_sleep_mode_bedroom_lights
              - switch.adaptive_lighting_sleep_mode_main_lights
              - switch.adaptive_lighting_sleep_mode_rgb_lights
              - switch.adaptive_lighting_sleep_mode_bathroom_lights
      else:
        - service: switch.turn_off
          target:
            entity_id: *sleep_lights
