###############################################################################
## Light - Office Charlie On
###############################################################################
- id: light_office_fan_light_charlie_on
  alias: "[Light] Office Fan Light Charlie On"
  description: "Turn on Charlie home alone light."
  max_exceeded: silent
  trigger:
    - platform: state
      entity_id:
        - input_boolean.charlie_home_alone
        - binary_sensor.nighttime_illuminance_lights
      to: "on"

    - platform: state
      entity_id: input_select.occupancy_mode
      to: Away
      for:
        minutes: 5
  condition:
    - condition: state
      entity_id:
        - input_boolean.charlie_home_alone
        - binary_sensor.nighttime_illuminance_lights
      state: "on"
  action:
    - service: script.turn_light_on
      data:
        lights: light.office_fan_light
        brightness: 10
        activate_timer: false
        override: true

###############################################################################
## Light - Office Light Charlie Off
###############################################################################
- id: light_office_fan_light_charlie_off
  alias: "[Light] Office Fan Light Charlie Off"
  description: "Turn off Charlie home alone light."
  max_exceeded: silent
  trigger:
    - platform: state
      entity_id: input_boolean.charlie_home_alone
      to: "off"
      for:
        minutes: 15

    - platform: state
      entity_id: binary_sensor.nighttime_illuminance_lights
      to: "off"
  condition:
    - condition: state
      entity_id: light.office_fan_light
      state: "on"

    - condition: state
      entity_id: binary_sensor.office_motion
      state: "off"
  action:
    - service: script.turn_light_off
      data:
        lights: light.office_fan_light
        bypass_timer: true
