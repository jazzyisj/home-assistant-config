#######################################################################################################################
## Mobile - Phone In Use
#######################################################################################################################
- id: mobile_phone_in_use
  alias: '[Mobile] Phone In Use'
  description: 'Turn down media players when a phone is in use.'
  mode: restart
  trigger:
    - platform: state
      entity_id: binary_sensor.mobile_phone_in_use
      to: 'on'
  condition:
    - condition: state
      entity_id: input_boolean.media_player_automation
      state: 'on'
  action:
    - service: script.set_media_player_volumes
      data:
        source: phone_all

    - wait_template: "{{ is_state('binary_sensor.mobile_phone_in_use','off') }}"
      timeout:
        minutes: 60
      continue_on_timeout: false

    - service: script.set_media_player_volumes
      data:
        source: phone_off
