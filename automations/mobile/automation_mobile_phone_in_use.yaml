###############################################################################
## Mobile - Phone In Use
###############################################################################
- id: mobile_phone_in_use
  alias: '[Mobile] Phone In Use'
  description: 'Adjust media players volume when phone in use.'
  mode: queued
  trigger:
    - platform: state
      entity_id: binary_sensor.mobile_phone_in_use
      to:
        - 'on'
        - 'off'
      from:
        - 'on'
        - 'off'
  condition:
    - condition: state
      entity_id: input_boolean.media_player_automation
      state: 'on'

    - condition: state
      entity_id: input_boolean.startup_pending
      state: 'off'
  action:
    - choose:
        - conditions:
            - condition: state
              entity_id: binary_sensor.mobile_phone_in_use
              state: 'on'
          sequence:
            - service: script.media_players_set_volumes
              data:
                source: phone_all
      default:
        - service: script.media_players_set_volumes
          data:
            source: phone_off
