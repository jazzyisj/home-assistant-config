###############################################################################
## Mobile - Sheri Phone Quiet Time
###############################################################################
- id: mobile_sheri_phone_quiet_time
  alias: '[Mobile] Sheri Phone Quiet Time'
  description: 'Adjust mobile volumes durning quiet times.'
  max_exceeded: silent
  trigger:
    - platform: state
      entity_id: binary_sensor.quiet_time
      to: ~
  condition:
    - condition: state
      entity_id: binary_sensor.sheri_home
      state: 'on'

    - condition: template
      alias: 'To/from state not unknown/unavailable'
      value_template: >
        {{ trigger.to_state.state not in ['unknown','unavailable']
            and trigger.from_state.state not in ['unknown','unavailable'] }}
  action:
    - choose:
        - conditions:
            - condition: state
              entity_id: binary_sensor.quiet_time
              state: 'on'
          sequence:
            - service: number.set_value
              target:
                entity_id: number.sheri_phone_media_volume
              data:
                value: 8

            - service: number.set_value
              target:
                entity_id: number.sheri_phone_ringer_volume
              data:
                value: 3
      default:
        - service: number.set_value
          target:
            entity_id: number.sheri_phone_media_volume
          data:
            value: 15

        - service: number.set_value
          target:
            entity_id: number.sheri_phone_ringer_volume
          data:
            value: 5
