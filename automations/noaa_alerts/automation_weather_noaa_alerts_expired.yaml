#######################################################################################################################
## Weather - NOAA Alerts Expired
#######################################################################################################################
- id: weather_noaa_alerts_expired
  alias: "[Weather] NOAA Alerts Expired"
  description: Close all NOAA alert notifications, reset severity values.
  initial_state: true
  mode: single
  #max_exceeded: silent
  trigger:
    - platform: state
      entity_id: binary_sensor.noaa_alert_active
      to: 'off'

  action:
    - service: input_text.set_value
      data:
        entity_id: input_text.current_noaa_alert_severity
        value: cleared

    - service: input_text.set_value
      data:
        entity_id: input_text.previous_noaa_alert_severity
        value: cleared

    - service: script.close_notifications
      data:
        target: mobile
        tag: noaa_alert

    - delay:
        seconds: 180 # prevent recursive triggers