###############################################################################
## Notify - Presence LED Notification
###############################################################################
- id: notify_presence_led_notification
  alias: "[Notify] Presence LED Notification"
  description: "Set LED notification."
  mode: queued
  trigger:
    - platform: state
      entity_id:
        - binary_sensor.jason_home
        - binary_sensor.sheri_home
        - input_boolean.jason_almost_home
        - input_boolean.sheri_almost_home
        - alert.jason_phone_offline
        - alert.sheri_phone_offline
      to: ~
      not_from:
        - unknown
        - unavailable
      for: 15 # prevent trigger on temporary state changes

    - platform: template
      id: jason_heading_home
      value_template: >
        {{ 'person.jason' in state_attr('zone.heading_home','persons')
              and is_state_attr('proximity.jphone_home','dir_of_travel','towards') }}

    - platform: template
      id: sheri_heading_home
      value_template: >
        {{ 'person.sheri' in state_attr('zone.heading_home','persons')
              and is_state_attr('proximity.sphone_home','dir_of_travel','towards') }}
  action:
    - service: script.presence_led
