#######################################################################################################################
## Schedule - Morning Before Alarm
## - turn eco mode off to preheat/cool house when waking up
## - runs 30 minutes before scheduled wake time or at house wakeup time (whichever earlier)
## - default to days time if work shift unknown
## - only runs if someone home and still in night mode
#######################################################################################################################
- id: schedule_morning_before_alarm
  alias: "[Schedule] Morning Before Alarm"
  description: "Override HVAC mode before wakeup to preheat house."
  trigger:
    - platform: state
      entity_id: sensor.next_waketime
      attribute: pre_waketime
      to: true
  condition:
    - condition: state
      entity_id:
        - input_boolean.schedule_automation
        - binary_sensor.someone_home
        - input_boolean.house_wakeup
      state: 'on'

    - condition: state
      entity_id: input_select.occupancy_mode
      state: Night
  action:
    - service: input_boolean.turn_on
      target:
        entity_id: input_boolean.hvac_presence_override
