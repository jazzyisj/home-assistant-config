#######################################################################################################################
## Purge TTS Folder
#######################################################################################################################
- id: system_purge_tts_folder
  alias: "[System] Purge TTS Folder"
  description: "Purge TTS cache folder."
  initial_state: true
  mode: single
  trigger:
    # stagger from sensor.capture so they both don't fire at same time
    - platform: time
      at: '02:05:00'

  condition:
    - condition: state
      entity_id: input_boolean.system_automation
      state: 'on'

    # only run on the first of every month or when folder size is > 100 MB
    - condition: template
      value_template: "{{ now().day == 1 or states('sensor.tts')|int > 100 }}"

  action:
    # run folder purge shell command
    - service: shell_command.tts_purge_old