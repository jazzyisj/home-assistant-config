###############################################################################
## Presence - Jason Heading Home
###############################################################################
- id: presence_jason_heading_home
  alias: "[Presence] Jason Heading Home" #ISSUE doesn't work if zone is passive
  description: "Start someone heading home script."
  mode: single
  max_exceeded: silent
  trigger:
    - platform: template
      id: jason
      value_template: >
        {{ ('person.jason' in state_attr('zone.heading_home','persons')
                or 'person.jason' in state_attr('zone.almost_home','persons'))
              and is_state_attr('proximity.jphone_home','dir_of_travel','towards') }}
  condition:
    - condition: state
      entity_id: input_boolean.occupancy_notifications
      state: "on"
  action:
    - service: script.someone_heading_home
      data:
        person: jason

    - wait_template: "{{ is_state('person.jason','home') }}"
      timeout: 900

    - service: notify.jason #NOTIFY sheri
      data:
        message: clear_notification
        data:
          tag: jason_heading_home

###############################################################################
## Presence - Sheri Heading Home
###############################################################################
- id: presence_sheri_heading_home
  alias: "[Presence] Sheri Heading Home"
  description: "Start someone heading home script."
  mode: single
  max_exceeded: silent
  trigger:
    - platform: template
      id: sheri
      value_template: >
        {{ ('person.sheri' in state_attr('zone.heading_home','persons')
                or 'person.sheri' in state_attr('zone.almost_home','persons'))
              and is_state_attr('proximity.sphone_home','dir_of_travel','towards') }}
  condition:
    - condition: state
      entity_id: input_boolean.occupancy_notifications
      state: "on"
  action:
    - service: script.someone_heading_home
      data:
        person: sheri

    - wait_template: "{{ is_state('person.sheri','home') }}"
      timeout: 900

    - service: notify.jason
      data:
        message: clear_notification
        data:
          tag: sheri_heading_home
