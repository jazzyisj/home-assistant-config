###############################################################################
## Presence - Someone Leaving Work
## - required when person leaving work before end of scheduled work day
###############################################################################
- id: presence_someone_leaving_work
  alias: '[Presence] Someone Leaving Work'
  description: 'House to override occupancy mode to preheat/cool house when someone leaving work.'
  mode: parallel
  max: 5
  trigger:
    - platform: zone
      id: leave
      entity_id:
        - person.jason
        - person.sheri
      zone: zone.work
      event: leave
  condition:
    - condition: state
      entity_id: binary_sensor.someone_home
      state: 'off'

    # in work zone for at least 15 min (not just driving by)
    - '{{ now() - trigger.from_state.last_changed > timedelta(minutes=15) }}'
  action:
    - service: input_boolean.turn_on
      target:
        entity_id: input_boolean.hvac_presence_override
