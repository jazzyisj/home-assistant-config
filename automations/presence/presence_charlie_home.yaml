###############################################################################
## Presence - Charlie Home Alone On
###############################################################################
- id: presence_charlie_home_alone_on
  alias: "[Presence] Charlie Home Alone On"
  description: "Charlie home alone, music, lights."
  max_exceeded: silent
  trigger:
    - platform: state
      entity_id: input_select.occupancy_mode
      to: Away
      for:
        minutes: 5

    - platform: state
      entity_id: input_boolean.charlie_home_alone
      to: "on"
  condition:
    - condition: state
      entity_id: input_boolean.charlie_home_alone
      state: "on"
  action:
    - service: script.turn_fan_on
      data:
        fans: fan.living_room_fan
        percentage: 50

    - if:
        - condition: state
          entity_id: binary_sensor.someone_home
          state: "off"
      then:
        - service: switch.turn_on
          target:
            entity_id: switch.charlie_crate_camera_power

    - if:
        - condition: state
          entity_id: input_boolean.media_preset_enabled_charlie
          state: "on"
      then:
        #DISABLED play video instead
        # - service: script.media_play
        #   data:
        #     preset: charlie

        - service: media_player.play_media #IDEA add video to presets
          target:
            entity_id: media_player.living_room_chromecast
          data:
            media_content_type: cast
            media_content_id: '
              {
              "app_name": "youtube",
              "media_id": "CVdkGFNCXAA"
              }'
            enqueue: replace
            extra:
              autoplay: true

###############################################################################
## Presence - Turn Off Charlie Home Alone
###############################################################################
- id: presence_turn_off_charlie_home_alone
  alias: "[Presence] Turn Off Charlie Home Alone"
  description: "Turn off Charlie home alone boolean."
  trigger:
    - platform: state
      entity_id: input_select.occupancy_mode
      to: Home
  action:
    - service: input_boolean.turn_off
      target:
        entity_id: input_boolean.charlie_home_alone

###############################################################################
## Presence - Charlie Home Alone Off
###############################################################################
- id: presence_charlie_home_alone_off
  alias: "[Presence] Charlie Home Alone Off"
  description: "Turn off Charlie home alone, music, lights."
  max_exceeded: silent
  trigger:
    - platform: state
      entity_id: input_boolean.charlie_home_alone
      to: "off"
  action:
    - service: script.turn_fan_off
      data:
        fans: fan.office_fan

    - if:
        - condition: state
          entity_id: binary_sensor.someone_home
          state: "on"
      then:
        - service: switch.turn_off
          target:
            entity_id: switch.charlie_crate_camera_power

    - if:
        - condition: state
          entity_id: input_boolean.media_preset_enabled_charlie
          state: "on"
      then:
        - service: media_player.turn_off
          target:
            entity_id: media_player.office_speaker
