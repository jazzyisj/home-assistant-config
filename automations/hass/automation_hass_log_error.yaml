###############################################################################
## Hass Log Error Notification
# ERROR (MainThread) [homeassistant.components.websocket_api.http.connection] [281471996652272] ('Error', 'Missing device owner or root rights to reboot the device')
###############################################################################
- id: hass_log_error_notification
  alias: '[Hass] Log Error Notification'
  description: 'Notify on HASS log errors.'
  mode: queued
  variables:
    error: >
      {% if 'Missing device owner or root rights to reboot the device' in trigger.event.data.message[0] %}
        Fully Kiosk - Missing device owner or root rights to reboot the device.
      {% else %} {{ none }}
      {% endif %}
  trigger:
    - platform: event
      event_type: system_log_event
      event_data:
        level: ERROR
  condition: '{{ error != none }}'
  action:
    - service: browser_mod.toast
      data:
        duration: 30000
        message: '{{ error }}'

    - service: persistent_notification.create
      data:
        title: 'HASS Log Error'
        message: '{{ error }}'
        notification_id: kiosk_reboot

    - service: notify.kiosk_tts
      data:
        message: '{{ error }}'
