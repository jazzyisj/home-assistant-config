#######################################################################################################################
## Climate - Indoor High Humidity Alert
#######################################################################################################################
- id: camera_side_drive_camera_events #TODO how to separate cams
  alias: '[Camera] Side Drive Camera Events'
  description: 'Notifcation of Side Drive camera event.'
  max_exceeded: silent
  trigger:
    - platform: mqtt
      topic: frigate/events
  condition:
    - condition: state
      alias: 'Camera alerts are on'
      entity_id: input_boolean.camera_notifications
      state: 'on'
  action:
    - service: notify.jason
      data_template:
        message: "A {{ trigger.payload_json['after']['label'] }} was detected."
        data:
          tag: "{{ trigger.payload_json['after']['id'] }}"
          group: Alarm
          channel: Alert
          importance: max
          ttl: 0
          priority: high
          clickAction: /ccab4aaf_frigate/dashboard
          color: !secret WARNING_COLOR
          image: "{{ states('input_text.base_url') }}/api/frigate/notifications/{{ trigger.payload_json['after']['id'] }}/thumbnail.jpg?format=android"
          icon_url: !secret ALARM_ICON
          when: "{{ trigger.payload_json['after']['start_time']|int }}"
          actions:
            - action: URI
              title: 'Alarm'
              uri: app://com.thanksmister.iot.mqtt.alarmpanel
            - action: URI
              title: 'Cameras'
              uri: app://com.flir.consumer.flir.lorexcloud

    - delay: 30
