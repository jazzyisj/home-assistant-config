###############################################################################
## Camera - Tamper Detection Alert
###############################################################################
- id: camera_tamper_detection_alert
  alias: "[Camera] Tamper Detection Alert"
  description: "Camera tamper detection notification."
  mode: parallel
  trigger:
    - platform: state
      entity_id:
        - binary_sensor.side_drive_camera_tamper_detection
        - binary_sensor.side_door_camera_tamper_detection
        - binary_sensor.front_drive_camera_tamper_detection
        - binary_sensor.front_door_camera_tamper_detection
        - binary_sensor.front_yard_camera_tamper_detection
        - binary_sensor.side_gate_front_camera_tamper_detection
        - binary_sensor.side_gate_back_camera_tamper_detection
        - binary_sensor.back_yard_camera_tamper_detection
        - binary_sensor.back_door_camera_tamper_detection
        - binary_sensor.patio_door_camera_tamper_detection
        - binary_sensor.back_house_camera_tamper_detection
        - binary_sensor.garage_inside_camera_tamper_detection
      to: "on"
      for: 2 # tamper sensors sometime cycle on/off
  condition:
    - condition: state
      entity_id: input_boolean.camera_notifications
      state: "on"
  action:
    - service: notify.jason
      data:
        title: "Camera Tamper" # no auto dismiss
        message: >
          {{ state_attr(trigger.entity_id,'friendly_name')|replace(' Tamper Detection','') }}
        data:
          tag: "camera_tamper{{ trigger.entity_id.split('.')[1] }}"
          group: Alarm
          channel: Alert
          importance: max
          ttl: 0
          priority: high
          visibility: public
          notification_icon: mdi:cctv
          icon_url: !secret ALARM_ICON
          ledColor: !secret WARNING_COLOR
          color: !secret WARNING_COLOR
          vibrationPattern: !secret ALERT_VIBRATION
          clickAction: /lovelace/alarm
          actions:
            - title: "Alarm"
              action: URI
              uri: !secret ALARM_URI

            - title: "Cameras"
              action: URI
              uri: !secret LOREX_URI

            - title: "Alerts Off"
              action: turn_off_camera_alerts
